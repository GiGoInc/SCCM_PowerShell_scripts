<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <rdl:Language xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">=User!Language</rdl:Language>
  <Description>This report shows summary information for all software deployments</Description>
  <DataSources>
    <DataSource Name="ID5C6358F24BB64a1bA16E8D96795D8602">
      <DataSourceReference>default_reference</DataSourceReference>
      <rd:DataSourceID>feaac5ad-a180-4202-bea2-e69bf51b73fb</rd:DataSourceID>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet1">
      <Fields>
        <Field Name="MachineName">
          <DataField>MachineName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="VECIID">
          <DataField>VECIID</DataField>
          <rd:TypeName>System.Object</rd:TypeName>
        </Field>
        <Field Name="UserName">
          <DataField>UserName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ResourceID">
          <DataField>ResourceID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="CollectionID">
          <DataField>CollectionID</DataField>
          <rd:TypeName>System.Object</rd:TypeName>
        </Field>
        <Field Name="StateID">
          <DataField>StateID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>ID5C6358F24BB64a1bA16E8D96795D8602</DataSourceName>
        <CommandText>CREATE TABLE #assets(MachineID int, UserID int, StateID int)    
	  
			declare @modelID as int

			Select @modelID = ModelId from fn_rbac_ConfigurationItems(@UserSIDs)  where CI_ID = @VECIID
			begin
				
				CREATE TABLE #machines(ItemKey int)
				CREATE INDEX IX on #machines (ItemKey) 
				
				insert into #machines
				select cm.ResourceID from fn_rbac_FullCollectionMembership(@UserSIDs) cm where cm.CollectionID = @CollectionID and cm.IsClient=1
				
				IF @@ROWCOUNT &lt;&gt; 0
				begin
					insert into #assets(MachineID,UserID,StateID)  
					   select 
						machines.ItemKey as MachineID,
						ccs.UserID as UserID,
						ISNULL(ccs.ComplianceState, 6) as StateID
						from #machines machines
						LEFT JOIN (
						Select ResourceID, UserID, ComplianceState = case when ComplianceState = 3 or EnforcementState between 5000 and 5010 then 5 -- Error
																		 when EnforcementState in (2019, 2020) then 4 -- In Progress
																		 when ComplianceState = 1 and IsApplicable = 1 then 3 -- Installed
																		 when ComplianceState = 1 and IsApplicable = 0 then 2 -- Retained
																		 when ComplianceState &lt;&gt; 1 and IsApplicable = 0 then 1 -- Not Applicable
																	end
						from fn_rbac_CICurrentComplianceStatus(@UserSIDs)  where ModelID = @modelID		
						) ccs ON ccs.ResourceID = machines.ItemKey where ISNULL(ccs.ComplianceState, 6) = @StateID or @StateID = ''
				end
				drop table #machines
				  
				  
				CREATE TABLE #users(DiscUserID int, UserID int)
				CREATE INDEX IX on #users (UserID) 
				
				insert into #users
				select ud.ResourceID, us.UserID from fn_rbac_Collections(@UserSIDs)  co 
				INNER JOIN fn_rbac_CollectionExpandedUserMembers(@UserSIDs)  cm on cm.SiteID = co.SiteID
				INNER JOIN fn_rbac_R_User(@UserSIDs)  ud on ud.ResourceID = cm.UserItemKey
				LEFT JOIN fn_rbac_Users(@UserSIDs)  us on ud.Unique_User_Name0 = us.FullName    
				where co.SiteID = @CollectionID
				
				IF @@ROWCOUNT &lt;&gt; 0 
				begin
					-- Always summarize user data  
					insert into #assets(MachineID,UserID,StateID)  
						-- get users that are directly in the collection
						select ccs.ResourceID as MachineID,
						users.DiscUserID as UserID, 
						ISNULL(ccs.ComplianceState, 6) as StateID
						from #users users
						LEFT JOIN (
									Select ResourceID, UserID, ComplianceState = case when ComplianceState = 3 or EnforcementState between 5000 and 5010 then 5 -- Error
																					 when EnforcementState in (2019, 2020) then 4 -- In Progress
																					 when ComplianceState = 1 and IsApplicable = 1 then 3 -- Installed
																					 when ComplianceState = 1 and IsApplicable = 0 then 2 -- Retained
																					 when ComplianceState &lt;&gt; 1 and IsApplicable = 0 then 1 -- Not Applicable
																				end
									from fn_rbac_CICurrentComplianceStatus(@UserSIDs)  where ModelID = @modelID
						) ccs ON ccs.UserID = users.UserID where ISNULL(ccs.ComplianceState, 6) = @StateID or @StateID = ''
					
				end
				drop table #users

		 end -- End of IsTombstoned
		 
		 
		 
		Select  @VECIID as VECIID,@CollectionID as CollectionID,sysdisc.Netbios_Name0 as MachineName, sysdisc.ResourceID as ResourceID, ISNULL(users.FullName, userdisc.Unique_User_Name0) as UserName,StateID 
		from #assets assets
		INNER JOIN fn_rbac_R_System_Valid(@UserSIDs)  sysdisc on sysdisc.ResourceID = assets.MachineID
		LEFT JOIN fn_rbac_Users(@UserSIDs)  users on users.UserID = assets.UserID
		LEFT JOIN fn_rbac_R_User(@UserSIDs)  userdisc on userdisc.ResourceID = assets.UserID
		order by sysdisc.Netbios_Name0, ISNULL(users.FullName, userdisc.Unique_User_Name0)
		
		drop table #assets</CommandText>
        <QueryParameters>
          <QueryParameter Name="@UserSIDs">
            <Value>=Parameters!UserSIDs.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@VECIID">
            <Value>=Parameters!VirtualEnvironment.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@CollectionID">
            <Value>=Parameters!CollectionName.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@StateID">
            <Value>=Parameters!VEState.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="DataSet_VirtualEnvironment">
      <Fields>
        <Field Name="VECIID">
          <DataField>VECIID</DataField>
          <rd:UserDefined>true</rd:UserDefined>
        </Field>
        <Field Name="DisplayName">
          <DataField>DisplayName</DataField>
          <rd:UserDefined>true</rd:UserDefined>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>ID5C6358F24BB64a1bA16E8D96795D8602</DataSourceName>
        <CommandText>
			Select distinct ve.DisplayName, ve.CI_ID as VECIID 
			from fn_rbac_CIRelation(@UserSIDs)  cirAppToDT  
			join fn_rbac_CIRelation(@UserSIDs)  cirVEToDT on cirVEToDT.ToCIID = cirAppToDT.ToCIID
			join fn_rbac_AssignmentTargetedCIs(@UserSIDs)  cit on cit.CI_ID = cirAppToDT.FromCIID
			join fn_rbac_ListVirtualEnvironments(dbo.fn_LShortNameToLCID(@locale), @UserSIDs) ve on ve.CI_ID = cirVEToDT.FromCIID
			where cirAppToDT.RelationType = 9 and cirVEToDT.RelationType = 20
			order by ve.DisplayName
		</CommandText>
        <QueryParameters>
          <QueryParameter Name="@UserSIDs">
            <Value>=Parameters!UserSIDs.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@locale">
            <Value>=Parameters!locale.Value</Value>
            <rd:UserDefined>true</rd:UserDefined>
          </QueryParameter>
        </QueryParameters>
      </Query>
    </DataSet>
    <DataSet Name="DataSet_Collection">
      <Fields>
        <Field Name="CollectionID">
          <DataField>CollectionID</DataField>
          <rd:UserDefined>true</rd:UserDefined>
        </Field>
        <Field Name="CollectionName">
          <DataField>CollectionName</DataField>
          <rd:UserDefined>true</rd:UserDefined>
        </Field>
        <Field Name="Name">
          <Value>=SrsResources.Localization.GetDBString(Fields!CollectionName.Value, User!Language, "SMS_Collection-Name")</Value>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>ID5C6358F24BB64a1bA16E8D96795D8602</DataSourceName>
        <CommandText>
			Select distinct coll.CollectionID, coll.Name as CollectionName  
			from fn_rbac_CIRelation(@UserSIDs)  cirAppToDT  
			join fn_rbac_CIRelation(@UserSIDs)  cirVEToDT on cirVEToDT.ToCIID = cirAppToDT.ToCIID
			join fn_rbac_AssignmentTargetedCIs(@UserSIDs)  cit on cit.CI_ID = cirAppToDT.FromCIID
			join fn_rbac_CIAssignment(@UserSIDs)  cia on cia.AssignmentID = cit.AssignmentID
			join fn_rbac_Collection(@UserSIDs)  coll on coll.CollectionID = cia.CollectionID
			where cirAppToDT.RelationType = 9
			and cirVEToDT.RelationType = 20
			and cirVEToDT.FromCIID = @VECIID
			order by coll.Name 
		</CommandText>
        <QueryParameters>
          <QueryParameter Name="@UserSIDs">
            <Value>=Parameters!UserSIDs.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@VECIID">
            <Value>=Parameters!VirtualEnvironment.Value</Value>
            <rd:UserDefined>true</rd:UserDefined>
          </QueryParameter>
        </QueryParameters>
      </Query>
    </DataSet>
    <DataSet Name="DataSet_State">
      <Fields>
        <Field Name="StateDisplayName">
          <DataField>StateDisplayName</DataField>
          <rd:UserDefined>true</rd:UserDefined>
        </Field>
        <Field Name="StateID">
          <DataField>StateID</DataField>
          <rd:UserDefined>true</rd:UserDefined>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>ID5C6358F24BB64a1bA16E8D96795D8602</DataSourceName>
        <CommandText>="
        select N'" &amp;SrsResources.Localization.GetString("AllValues", User!Language)&amp; "' as StateDisplayName, '' as StateID 
        UNION ALL
        select  N'" &amp;SrsResources.Localization.GetString("VECIState_1", User!Language)&amp; "' as StateDisplayName, '1' as StateId
        UNION ALL
        select  N'" &amp;SrsResources.Localization.GetString("VECIState_2", User!Language)&amp; "' as StateDisplayName, '2' as StateId
        UNION ALL
        select  N'" &amp;SrsResources.Localization.GetString("VECIState_3", User!Language)&amp; "' as StateDisplayName, '3' as StateId
        UNION ALL
        select  N'" &amp;SrsResources.Localization.GetString("VECIState_4", User!Language)&amp; "' as StateDisplayName, '4' as StateId
        UNION ALL
        select  N'" &amp;SrsResources.Localization.GetString("VECIState_5", User!Language)&amp; "' as StateDisplayName, '5' as StateId
        UNION ALL
        select  N'" &amp;SrsResources.Localization.GetString("VECIState_6", User!Language)&amp; "' as StateDisplayName, '6' as StateId
        "</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="DataSetAdminID">
      <Query>
        <DataSourceName>ID5C6358F24BB64a1bA16E8D96795D8602</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@UserTokenSIDs">
            <Value>=Parameters!UserTokenSIDs.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>select dbo.fn_rbac_GetAdminIDsfromUserSIDs(@UserTokenSIDs) as UserSIDs</CommandText>
      </Query>
      <Fields>
        <Field Name="UserSIDs">
          <DataField>UserSIDs</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <Body>
    <ReportItems>
      <Tablix Name="Tablix2">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>2.45in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.58in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.71in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.24479in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TotalInstalled8">
                      <CanGrow>true</CanGrow>
                      <UserSort>
                        <SortExpression>=Fields!MachineName.Value</SortExpression>
                      </UserSort>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=SrsResources.Localization.GetString("MachineName", User!Language)</Value>
                              <rdl:Style xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
                                <rdl:FontFamily>Segoe UI</rdl:FontFamily>
                                <rdl:FontSize>9pt</rdl:FontSize>
                                <rdl:FontWeight>Bold</rdl:FontWeight>
                                <rdl:Color>Black</rdl:Color>
                              </rdl:Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TotalInstalled</rd:DefaultName>
                      <rdl:Style xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
                        <rdl:Border>
                          <rdl:Color>#557eb9</rdl:Color>
                          <rdl:Style>None</rdl:Style>
                        </rdl:Border>
                        <rdl:TopBorder>
                          <rdl:Style>Solid</rdl:Style>
                          <rdl:Width>1.5pt</rdl:Width>
                        </rdl:TopBorder>
                        <rdl:BottomBorder>
                          <rdl:Style>Solid</rdl:Style>
                          <rdl:Width>1.5pt</rdl:Width>
                        </rdl:BottomBorder>
                        <rdl:LeftBorder>
                          <rdl:Style>None</rdl:Style>
                        </rdl:LeftBorder>
                        <rdl:RightBorder>
                          <rdl:Style>None</rdl:Style>
                        </rdl:RightBorder>
                        <rdl:BackgroundColor>White</rdl:BackgroundColor>
                        <rdl:VerticalAlign>Bottom</rdl:VerticalAlign>
                        <rdl:PaddingLeft>5pt</rdl:PaddingLeft>
                        <rdl:PaddingRight>5pt</rdl:PaddingRight>
                        <rdl:PaddingTop>5pt</rdl:PaddingTop>
                        <rdl:PaddingBottom>5pt</rdl:PaddingBottom>
                      </rdl:Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TotalInstalled9">
                      <CanGrow>true</CanGrow>
                      <UserSort>
                        <SortExpression>=Fields!UserName.Value</SortExpression>
                      </UserSort>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=SrsResources.Localization.GetString("UserName", User!Language)</Value>
                              <rdl:Style xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
                                <rdl:FontFamily>Segoe UI</rdl:FontFamily>
                                <rdl:FontSize>9pt</rdl:FontSize>
                                <rdl:FontWeight>Bold</rdl:FontWeight>
                                <rdl:Color>Black</rdl:Color>
                              </rdl:Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TotalInstalled</rd:DefaultName>
                      <rdl:Style xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
                        <rdl:Border>
                          <rdl:Color>#557eb9</rdl:Color>
                          <rdl:Style>None</rdl:Style>
                        </rdl:Border>
                        <rdl:TopBorder>
                          <rdl:Style>Solid</rdl:Style>
                          <rdl:Width>1.5pt</rdl:Width>
                        </rdl:TopBorder>
                        <rdl:BottomBorder>
                          <rdl:Style>Solid</rdl:Style>
                          <rdl:Width>1.5pt</rdl:Width>
                        </rdl:BottomBorder>
                        <rdl:LeftBorder>
                          <rdl:Style>None</rdl:Style>
                        </rdl:LeftBorder>
                        <rdl:RightBorder>
                          <rdl:Style>None</rdl:Style>
                        </rdl:RightBorder>
                        <rdl:BackgroundColor>White</rdl:BackgroundColor>
                        <rdl:VerticalAlign>Bottom</rdl:VerticalAlign>
                        <rdl:PaddingLeft>5pt</rdl:PaddingLeft>
                        <rdl:PaddingRight>5pt</rdl:PaddingRight>
                        <rdl:PaddingTop>5pt</rdl:PaddingTop>
                        <rdl:PaddingBottom>5pt</rdl:PaddingBottom>
                      </rdl:Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TotalInstalled10">
                      <CanGrow>true</CanGrow>
                      <UserSort>
                        <SortExpression>=SrsResources.Localization.GetString("VECIState_" + CStr(Fields!StateID.Value), User!Language)</SortExpression>
                      </UserSort>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=SrsResources.Localization.GetString("VEStateName", User!Language)</Value>
                              <rdl:Style xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
                                <rdl:FontFamily>Segoe UI</rdl:FontFamily>
                                <rdl:FontSize>9pt</rdl:FontSize>
                                <rdl:FontWeight>Bold</rdl:FontWeight>
                                <rdl:Color>Black</rdl:Color>
                              </rdl:Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TotalInstalled</rd:DefaultName>
                      <rdl:Style xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
                        <rdl:Border>
                          <rdl:Color>#557eb9</rdl:Color>
                          <rdl:Style>None</rdl:Style>
                        </rdl:Border>
                        <rdl:TopBorder>
                          <rdl:Style>Solid</rdl:Style>
                          <rdl:Width>1.5pt</rdl:Width>
                        </rdl:TopBorder>
                        <rdl:BottomBorder>
                          <rdl:Style>Solid</rdl:Style>
                          <rdl:Width>1.5pt</rdl:Width>
                        </rdl:BottomBorder>
                        <rdl:LeftBorder>
                          <rdl:Style>None</rdl:Style>
                        </rdl:LeftBorder>
                        <rdl:RightBorder>
                          <rdl:Style>None</rdl:Style>
                        </rdl:RightBorder>
                        <rdl:BackgroundColor>White</rdl:BackgroundColor>
                        <rdl:VerticalAlign>Bottom</rdl:VerticalAlign>
                        <rdl:PaddingLeft>5pt</rdl:PaddingLeft>
                        <rdl:PaddingRight>5pt</rdl:PaddingRight>
                        <rdl:PaddingTop>5pt</rdl:PaddingTop>
                        <rdl:PaddingBottom>5pt</rdl:PaddingBottom>
                      </rdl:Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.92188in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="MachineName">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!MachineName.Value</Value>
                              <Style>
                                <TextDecoration>Underline</TextDecoration>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>MachineName</rd:DefaultName>
                      <ActionInfo>
                        <Actions>
                          <Action>
                            <Drillthrough>
                              <ReportName>=iif(Fields!StateID.Value &lt;&gt; 6, "App-V Virtual Environment Results For Asset", Nothing)</ReportName>
                              <Parameters>
                                <Parameter Name="VirtualEnvironment">
                                  <Value>=Fields!VECIID.Value</Value>
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                                <Parameter Name="computer">
                                  <Value>=Fields!ResourceID.Value</Value>
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                                <Parameter Name="UserName">
                                  <Value>=Fields!UserName.Value</Value>
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                                <Parameter Name="UserFilter">
                                  <Value />
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                                <Parameter Name="DeviceFilter">
                                  <Value />
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                              </Parameters>
                            </Drillthrough>
                          </Action>
                        </Actions>
                      </ActionInfo>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=iif(RowNumber("DataSet1") Mod 2 = 0,"#e9eaed", "None")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <rd:Selected>true</rd:Selected>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="UserName">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!UserName.Value</Value>
                              <Style>
                                <TextDecoration>Underline</TextDecoration>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>UserName</rd:DefaultName>
                      <ActionInfo>
                        <Actions>
                          <Action>
                            <Drillthrough>
                              <ReportName>=iif(Fields!StateID.Value &lt;&gt; 6, "App-V Virtual Environment Results For Asset", Nothing)</ReportName>
                              <Parameters>
                                <Parameter Name="VirtualEnvironment">
                                  <Value>=Fields!VECIID.Value</Value>
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                                <Parameter Name="computer">
                                  <Value>=Fields!ResourceID.Value</Value>
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                                <Parameter Name="UserName">
                                  <Value>=Fields!UserName.Value</Value>
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                                <Parameter Name="UserFilter">
                                  <Value />
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                                <Parameter Name="DeviceFilter">
                                  <Value />
                                  <Omit>=iif(Fields!StateID.Value = 6, true, false)</Omit>
                                </Parameter>
                              </Parameters>
                            </Drillthrough>
                          </Action>
                        </Actions>
                      </ActionInfo>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=iif(RowNumber("DataSet1") Mod 2 = 0,"#e9eaed", "None")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="StateID">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=SrsResources.Localization.GetString("VECIState_" + CStr(Fields!StateID.Value), User!Language)</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>StateID</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>=iif(RowNumber("DataSet1") Mod 2 = 0,"#e9eaed", "None")</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember>
              <TablixMembers>
                <TablixMember>
                  <TablixMembers>
                    <TablixMember>
                      <TablixMembers>
                        <TablixMember>
                          <Group Name="Details" />
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DataSet1</DataSetName>
        <rdl:Top xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">0.33in
    </rdl:Top>
        <rdl:Left xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">0in</rdl:Left>
        <Height>1.16667in</Height>
        <Width>7.73958in</Width>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
      <rdl:Rectangle Name="ReportDescriptionRectangle" xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
        <rdl:ReportItems>
          <rdl:Tablix Name="ReportDescriptionTablix">
            <rdl:DataSetName>DataSet1</rdl:DataSetName>
            <rdl:TablixBody>
              <rdl:TablixColumns>
                <rdl:TablixColumn>
                  <rdl:Width>1.25in</rdl:Width>
                </rdl:TablixColumn>
                <rdl:TablixColumn>
                  <rdl:Width>6.239999771118164in</rdl:Width>
                </rdl:TablixColumn>
              </rdl:TablixColumns>
              <rdl:TablixRows>
                <rdl:TablixRow>
                  <rdl:Height>0.4in</rdl:Height>
                  <rdl:TablixCells>
                    <rdl:TablixCell>
                      <rdl:CellContents>
                        <rdl:Textbox Name="DescriptionLabelTextbox">
                          <rdl:CanGrow>true</rdl:CanGrow>
                          <rdl:KeepTogether>true</rdl:KeepTogether>
                          <rdl:Paragraphs>
                            <rdl:Paragraph>
                              <rdl:TextRuns>
                                <rdl:TextRun>
                                  <rdl:Value>=SrsResources.Localization.GetString("Description", User!Language)</rdl:Value>
                                  <rdl:Style>
                                    <rdl:FontFamily>Segoe UI</rdl:FontFamily>
                                    <rdl:FontWeight>Bold</rdl:FontWeight>
                                    <rdl:FontSize>9pt</rdl:FontSize>
                                    <rdl:Color>Black</rdl:Color>
                                  </rdl:Style>
                                </rdl:TextRun>
                              </rdl:TextRuns>
                              <rdl:Style />
                            </rdl:Paragraph>
                          </rdl:Paragraphs>
                          <rd:DefaultName>Textbox16</rd:DefaultName>
                          <rdl:Style>
                            <rdl:Border>
                              <rdl:Color>LightGrey</rdl:Color>
                              <rdl:Style>Solid</rdl:Style>
                            </rdl:Border>
                            <rdl:BackgroundColor>Gainsboro</rdl:BackgroundColor>
                            <rdl:PaddingLeft>2pt</rdl:PaddingLeft>
                            <rdl:PaddingRight>2pt</rdl:PaddingRight>
                            <rdl:PaddingTop>2pt</rdl:PaddingTop>
                            <rdl:PaddingBottom>2pt</rdl:PaddingBottom>
                          </rdl:Style>
                        </rdl:Textbox>
                      </rdl:CellContents>
                    </rdl:TablixCell>
                    <rdl:TablixCell>
                      <rdl:CellContents>
                        <rdl:Textbox Name="DescriptionTextbox">
                          <rdl:CanGrow>true</rdl:CanGrow>
                          <rdl:KeepTogether>true</rdl:KeepTogether>
                          <rdl:Paragraphs>
                            <rdl:Paragraph>
                              <rdl:TextRuns>
                                <rdl:TextRun>
                                  <rdl:Value>=SrsResources.Localization.GetString("Virtual_Environment_Assets_Details_Description", User!Language)</rdl:Value>
                                  <rdl:Style>
                                    <rdl:FontFamily>Segoe UI</rdl:FontFamily>
                                    <rdl:FontSize>9pt</rdl:FontSize>
                                    <rdl:FontWeight>Normal</rdl:FontWeight>
                                    <rdl:Color>Black</rdl:Color>
                                  </rdl:Style>
                                </rdl:TextRun>
                              </rdl:TextRuns>
                              <rdl:Style />
                            </rdl:Paragraph>
                          </rdl:Paragraphs>
                          <rd:DefaultName>Textbox18</rd:DefaultName>
                          <rdl:Visibility>
                            <rdl:Hidden>true</rdl:Hidden>
                            <rdl:ToggleItem>DescriptionLabelTextbox</rdl:ToggleItem>
                          </rdl:Visibility>
                          <rdl:Style>
                            <rdl:Border>
                              <rdl:Color>LightGrey</rdl:Color>
                              <rdl:Style>Solid</rdl:Style>
                            </rdl:Border>
                            <rdl:BackgroundColor>Gainsboro</rdl:BackgroundColor>
                            <rdl:PaddingLeft>5pt</rdl:PaddingLeft>
                            <rdl:PaddingRight>2pt</rdl:PaddingRight>
                            <rdl:PaddingTop>2pt</rdl:PaddingTop>
                            <rdl:PaddingBottom>2pt</rdl:PaddingBottom>
                          </rdl:Style>
                        </rdl:Textbox>
                      </rdl:CellContents>
                    </rdl:TablixCell>
                  </rdl:TablixCells>
                </rdl:TablixRow>
              </rdl:TablixRows>
            </rdl:TablixBody>
            <rdl:TablixColumnHierarchy>
              <rdl:TablixMembers>
                <rdl:TablixMember />
                <rdl:TablixMember />
              </rdl:TablixMembers>
            </rdl:TablixColumnHierarchy>
            <rdl:TablixRowHierarchy>
              <rdl:TablixMembers>
                <rdl:TablixMember />
              </rdl:TablixMembers>
            </rdl:TablixRowHierarchy>
            <rdl:Top>0.0in</rdl:Top>
            <rdl:Height>0.2in</rdl:Height>
            <rdl:Style>
              <rdl:Border>
                <rdl:Style>None</rdl:Style>
              </rdl:Border>
            </rdl:Style>
          </rdl:Tablix>
        </rdl:ReportItems>
        <rdl:KeepTogether>true</rdl:KeepTogether>
        <rdl:Left>0in</rdl:Left>
        <rdl:Height>0.21181in</rdl:Height>
        <rdl:Top>0.0in</rdl:Top>
        <rdl:Width>7.739999771118164in</rdl:Width>
        <rdl:ZIndex>1</rdl:ZIndex>
        <rdl:Style>
          <rdl:Border>
            <rdl:Style>None</rdl:Style>
          </rdl:Border>
          <rdl:BackgroundColor>Gainsboro</rdl:BackgroundColor>
        </rdl:Style>
      </rdl:Rectangle>
      <rdl:Line Name="ReportDescriptionLine" xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
        <rdl:Top>0.25in</rdl:Top>
        <rdl:Left>0in</rdl:Left>
        <rdl:Height>0in</rdl:Height>
        <rdl:Width>7.739999771118164in</rdl:Width>
        <rdl:ZIndex>2</rdl:ZIndex>
        <rdl:Style>
          <rdl:Border>
            <rdl:Style>Double</rdl:Style>
            <rdl:Width>1.5pt</rdl:Width>
          </rdl:Border>
          <rdl:TopBorder>
            <rdl:Style>Double</rdl:Style>
            <rdl:Width>1.5pt</rdl:Width>
          </rdl:TopBorder>
          <rdl:BottomBorder>
            <rdl:Style>Double</rdl:Style>
            <rdl:Width>1.5pt</rdl:Width>
          </rdl:BottomBorder>
          <rdl:LeftBorder>
            <rdl:Style>Double</rdl:Style>
            <rdl:Width>1.5pt</rdl:Width>
          </rdl:LeftBorder>
          <rdl:RightBorder>
            <rdl:Style>Double</rdl:Style>
            <rdl:Width>1.5pt</rdl:Width>
          </rdl:RightBorder>
        </rdl:Style>
      </rdl:Line>
    </ReportItems>
    <Height>2.24667in</Height>
    <Style>
      <Border>
        <Style>None</Style>
      </Border>
    </Style>
  </Body>
  <ReportParameters>
    <ReportParameter Name="UserTokenSIDs">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>=SrsResources.UserIdentity.GetUserSIDs(User!UserID)</Value>
        </Values>
      </DefaultValue>
      <Hidden>true</Hidden>
    </ReportParameter>
    <ReportParameter Name="UserSIDs">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>DataSetAdminID</DataSetName>
          <ValueField>UserSIDs</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Hidden>true</Hidden>
    </ReportParameter>
    <ReportParameter Name="locale">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>=User!Language</Value>
        </Values>
      </DefaultValue>
      <Prompt>Virtual_Environment_Assets_Details_parameter_locale</Prompt>
      <Hidden>true</Hidden>
    </ReportParameter>
    <ReportParameter Name="VirtualEnvironment">
      <DataType>String</DataType>
      <Prompt>Virtual Environment Name</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DataSet_VirtualEnvironment</DataSetName>
          <ValueField>VECIID</ValueField>
          <LabelField>DisplayName</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="CollectionName">
      <DataType>String</DataType>
      <Prompt>Collection Name</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DataSet_Collection</DataSetName>
          <ValueField>CollectionID</ValueField>
          <LabelField>Name</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="VEState">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <Values>
          <Value />
        </Values>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>Virtual Environment State</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DataSet_State</DataSetName>
          <ValueField>StateID</ValueField>
          <LabelField>StateDisplayName</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
  </ReportParameters>
  <Width>17.77076in</Width>
  <rdl:Page xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
    <rdl:PageHeader>
      <rdl:Height>1.1in</rdl:Height>
      <rdl:PrintOnFirstPage>true</rdl:PrintOnFirstPage>
      <rdl:PrintOnLastPage>true</rdl:PrintOnLastPage>
      <rdl:ReportItems>
        <rdl:Rectangle Name="BackgroundColorRectangle">
          <rdl:ReportItems>
            <rdl:Image Name="RightHeaderImage">
              <rdl:Source>External</rdl:Source>
              <rdl:Value>/ConfigMgr_DC1/Report Resources/Report_Header_Right.png</rdl:Value>
              <rdl:Top>0.0in</rdl:Top>
              <rdl:Left>5.3999998569488525in</rdl:Left>
              <rdl:Height>0.75in</rdl:Height>
              <rdl:Width>2.3399999141693115in</rdl:Width>
              <rdl:Style>
                <rdl:Border>
                  <rdl:Style>None</rdl:Style>
                </rdl:Border>
              </rdl:Style>
            </rdl:Image>
            <rdl:Image Name="CenterHeaderImage">
              <rdl:Source>External</rdl:Source>
              <rdl:Sizing>Fit</rdl:Sizing>
              <rdl:Value>/ConfigMgr_DC1/Report Resources/Report_Header_Center.png</rdl:Value>
              <rdl:Top>0.0in</rdl:Top>
              <rdl:Left>0.20999999344348907in</rdl:Left>
              <rdl:Height>0.75in</rdl:Height>
              <rdl:Width>5.189999580383301in</rdl:Width>
              <rdl:Style>
                <rdl:Border>
                  <rdl:Style>None</rdl:Style>
                </rdl:Border>
              </rdl:Style>
            </rdl:Image>
            <rdl:Image Name="LeftHeaderImage">
              <rdl:Source>External</rdl:Source>
              <rdl:Value>/ConfigMgr_DC1/Report Resources/Report_Header_Left.png</rdl:Value>
              <rdl:Top>0.0in</rdl:Top>
              <rdl:Left>0.0in</rdl:Left>
              <rdl:Height>0.75in</rdl:Height>
              <rdl:Width>0.20999999344348907in</rdl:Width>
              <rdl:ZIndex>1</rdl:ZIndex>
              <rdl:Style>
                <rdl:Border>
                  <rdl:Style>None</rdl:Style>
                </rdl:Border>
              </rdl:Style>
            </rdl:Image>
          </rdl:ReportItems>
          <rdl:KeepTogether>true</rdl:KeepTogether>
          <rdl:Top>0.0in</rdl:Top>
          <rdl:Left>0in</rdl:Left>
          <rdl:Height>0.75in</rdl:Height>
          <rdl:Width>7.739999771118164in</rdl:Width>
          <rdl:Style>
            <rdl:Border>
              <rdl:Style>None</rdl:Style>
            </rdl:Border>
            <rdl:BackgroundColor>#e2e9f2</rdl:BackgroundColor>
          </rdl:Style>
        </rdl:Rectangle>
        <rdl:Textbox Name="ReportTitleTextbox">
          <rdl:CanGrow>true</rdl:CanGrow>
          <rdl:KeepTogether>true</rdl:KeepTogether>
          <rdl:Paragraphs>
            <rdl:Paragraph>
              <rdl:TextRuns>
                <rdl:TextRun>
                  <rdl:Value>=SrsResources.Localization.GetString("Virtual_Environment_Assets_Details_Name", User!Language) + "  "</rdl:Value>
                  <rdl:Style>
                    <rdl:FontFamily>Segoe UI</rdl:FontFamily>
                    <rdl:FontSize>17pt</rdl:FontSize>
                    <rdl:FontWeight>Bold</rdl:FontWeight>
                    <rdl:Color>Black</rdl:Color>
                  </rdl:Style>
                </rdl:TextRun>
              </rdl:TextRuns>
              <rdl:Style />
            </rdl:Paragraph>
          </rdl:Paragraphs>
          <rd:DefaultName>Textbox54</rd:DefaultName>
          <rdl:Top>0.75in</rdl:Top>
          <rdl:Left>0in</rdl:Left>
          <rdl:Height>0.35in</rdl:Height>
          <rdl:Width>7.739999771118164in</rdl:Width>
          <rdl:ZIndex>1</rdl:ZIndex>
          <rdl:Style>
            <rdl:Border>
              <rdl:Style>None</rdl:Style>
            </rdl:Border>
            <rdl:BackgroundColor>Gainsboro</rdl:BackgroundColor>
            <rdl:PaddingLeft>2pt</rdl:PaddingLeft>
            <rdl:PaddingRight>2pt</rdl:PaddingRight>
            <rdl:PaddingTop>2pt</rdl:PaddingTop>
            <rdl:PaddingBottom>2pt</rdl:PaddingBottom>
          </rdl:Style>
        </rdl:Textbox>
      </rdl:ReportItems>
      <rdl:Style>
        <rdl:Border>
          <rdl:Style>None</rdl:Style>
        </rdl:Border>
      </rdl:Style>
    </rdl:PageHeader>
    <rdl:PageFooter>
      <rdl:Height>0.45in</rdl:Height>
      <rdl:PrintOnFirstPage>true</rdl:PrintOnFirstPage>
      <rdl:PrintOnLastPage>true</rdl:PrintOnLastPage>
      <rdl:Style>
        <rdl:Border>
          <rdl:Style>None</rdl:Style>
        </rdl:Border>
      </rdl:Style>
    </rdl:PageFooter>
    <rdl:PageHeight>27.94cm</rdl:PageHeight>
    <rdl:PageWidth>21.59cm</rdl:PageWidth>
    <rdl:LeftMargin>2.54cm</rdl:LeftMargin>
    <rdl:RightMargin>2.54cm</rdl:RightMargin>
    <rdl:TopMargin>2.54cm</rdl:TopMargin>
    <rdl:BottomMargin>2.54cm</rdl:BottomMargin>
    <rdl:Style />
  </rdl:Page>
  <rdl:CodeModules xmlns:rdl="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
    <rdl:CodeModule>SrsResources, culture=neutral</rdl:CodeModule>
  </rdl:CodeModules>
  <rd:ReportID>0290ab82-8b1d-4ab4-8e9d-8ec3d1bae303</rd:ReportID>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportServerUrl>http://nova93726/ReportServer_AE804FD1F91</rd:ReportServerUrl>
</Report>