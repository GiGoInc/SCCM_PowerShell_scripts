$RegKey1 = "IPM.Note.EnterpriseVault.PendingArchive"

# ENCODEDSCRIPT # Begin Configuration Manager encoded script block # 77u/JFJlZ0tleTEgPSAiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlBlbmRpbmdBcmNoaXZlIg0KJFJlZ0tleTIgPSAiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlBlbmRpbmdBcmNoaXZlLkFyY2hpdmVNZSINCiRSZWdLZXkzID0gIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dC5EZWxldGVNZSINCiRSZWdLZXk0ID0gIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dC5SZXN0b3JlTWUiDQokUmVnS2V5NSA9ICJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQiDQokUmVnS2V5NiA9ICJEaXNhYmxlQ3VzdG9tRm9ybUl0ZW1TY3JpcHQiDQokUmVnS2V5NyA9ICJFbmFibGVSb2FtaW5nRm9sZGVySG9tZXBhZ2VzIg0KDQoNCiRSZWdUeXBlMSA9ICJTVFJJTkciDQokUmVnVHlwZTIgPSAiRFdPUkQiDQoNCiRSZWdWYWx1ZTEgPSAiIg0KJFJlZ1ZhbHVlMiA9ICIwIg0KJFJlZ1ZhbHVlMyA9ICIxIg0KDQpGdW5jdGlvbiBDaGVja1JlZyAoJFJlZ1BhdGgsJFJlZ1BhdGgyLCAkUmVnUGF0aDMpDQp7DQogICAgJFJlZzEgPSBHZXQtSXRlbVByb3BlcnR5ICRSZWdQYXRoMSAtTmFtZSAkUmVnS2V5MQ0KICAgICRSZWcyID0gR2V0LUl0ZW1Qcm9wZXJ0eSAkUmVnUGF0aDEgLU5hbWUgJFJlZ0tleTINCiAgICAkUmVnMyA9IEdlXX1JdGVtUHJvcGVydHkgJFJlZ1BhdGgxIC1OYW1lICRSZWdLZXkzDQogICAgJFJlZzQgPSBHZXQtSXRlbVByb3BlcnR5ICRSZWdQYXRoMSAtTmFtZSAkUmVnS2V5NA0KICAgICRSZWc1ID0gR2V0LUl0ZW1Qcm9wZXJ0eSAkUmVnUGF0aDEgLU5hbWUgJFJlZ0tleTUNCiAgICAkUmVnNiA9IEdlXX1JdGVtUHJvcGVydHkgJFJlZ1BhdGgyIC1OYW1lICRSZWdLZXk2DQogICAgJFJlZzcgPSBHZXQtSXRlbVByb3BlcnR5ICRSZWdQYXRoMyAtTmFtZSAkUmVnS2V5Nw0KICAgIA0KICAgIElmICgoJFJlZzEuIklQTWAuTm90ZS5FbnRlcnByaXNlVmF1bHRgLlBlbmRpbmdBcmNoaXZlIiDigJNlcSAnJykgLWFuZCBgDQogICAgCSgkUmVnMi4iSVBNYC5Ob3RlLkVudGVycHJpc2VWYXVsdGAuUGVuZGluZ0FyY2hpdmUuQXJjaGl2ZU1lIiDigJNlcSAnJykgLWFuZCBgDQogICAgCSgkUmVnMy4iSVBNYC5Ob3RlLkVudGVycHJpc2VWYXVsdGAuU2hvcnRjdXQuRGVsZXRlTWUiIOKAk2VxICcnKSAtYW5kIGANCiAgICAJKCRSZWc0LiJJUE1gLk5vdGUuRW50ZXJwcmlzZVZhdWx0YC5TaG9ydGN1dC5SZXN0b3JlTWUiIOKAk2VxICcnKSAtYW5kIGANCiAgICAJKCRSZWc1LiJJUE1gLk5vdGUuRW50ZXJwcmlzZVZhdWx0YC5TaG9ydGN1dCIg4oCTZXEgJycpIC1hbmQgYA0KICAgIAkoJFJlZzYuIkRpc2FibGVDdXN0b21Gb3JtSXRlbVNjcmlwdCIg4oCTZXEgJzAnKSAtYW5kIGANCiAgICAJKCRSZWc3LiJFbmFibGVSb2FtaW5nRm9sZGVySG9tZXBhZ2VzIiDigJNlcSAnMScpDQogICAgCSkNCiAgICAJe1dyaXRlLUhvc3QgJ0NvbXBsaWFudCd9DQogICAgRWxzZXtXcml0ZS1Ib3N0ICdOb24tQ29tcGxpYW50J30NCn0NCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMgQ2hlY2sgT1MgVHlwZQ0KVHJ5DQp7DQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTdG9wIjsgI01ha2UgYWxsIGVycm9ycyB0ZXJtaW5hdGluZw0KICAgICRTeXN0ZW0gPSBnd21pIFdpbjMyX0NvbXB1dGVyU3lzdGVtICMgbm9ybWFsbHkgbm9uLXRlcm1pbmF0aW5nDQogICAgJFR5cGUgPSAkU3lzdGVtLlN5c3RlbVR5cGUNCg0KICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgICMgQ2hlY2sgT3V0bG9vay5leGUgVmVyc2lvbg0KICAgIFRyeQ0KICAgIHsNCiAgICAgICAgIyAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1NpbGVudGx5Q29udGludWUnDQogICAgICAgICRSZWcgPSBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5XTo6T3BlbkJhc2VLZXkoJ0xvY2FsTWFjaGluZScsICdkZWZhdWx0JykNCiAgICAgICAgJFJlZzIgPSBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5XTo6T3BlbkJhc2VLZXkoJ0N1cnJlbnRVc2VyJywgJ2RlZmF1bHQnKQ0KDQogICAgICAgIElGICgkVHlwZSAtZXEgJ3g2NC1iYXNlZCBQQycpDQogICAgICAgIHsNCiAgICAgICAgICAgIElGIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNFxPVVRMT09LLkVYRSIpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgJFJlZ1BhdGgxID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xPdXRsb29rXFNlY3VyaXR5Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xPdXRsb29rXFNlY3VyaXR5Ig0KICAgICAgICAgICAgICAgIENoZWNrUmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTRcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTVcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KCQkJCSRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiSEtMTTpcU09GVFdBUkVcV09XNjQzMk5vZGVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJIS0xNOlxTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCQkkUmVnUGF0aDMgPSAiSEtDVTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgQ2hlY2tSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIEVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCgkJCQkkUmVnUGF0aDEgPSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNC4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KCQkJCSRSZWdQYXRoMiA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCQkkUmVnUGF0aDMgPSAiSEtDVTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNC4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgQ2hlY2tSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIElGIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpDQogICAgICAgICAgICB7DQoJCQkgICAgJFJlZ1BhdGgxID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXEZvcm1zXFRydXN0ZWRGb3JtU2NyaXB0TGlzdCINCgkJCSAgICAkUmVnUGF0aDIgPSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQoJCQkJJFJlZ1BhdGgzID0gIkhLQ1U6XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJICAgIENoZWNrUmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCSAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIENhdGNoDQogICAgew0KICAgICAgICBJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzA2QkEiKQ0KICAgICAgICB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICdXTUlfLV9SUENfU2VydmVyX1VuYXZhaWxhYmxlJw0KICAgICAgICB9DQogICAgICAgIEVsc2VJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzAwMDUiKQ0KICAgICAgICB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICdXTUlfLV9BY2Nlc3NfaXNfRGVuaWVkJw0KICAgICAgICB9DQogICAgICAgIEVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgW3N0cmluZ10kVmVyODYgPSAkZXJyb3JbMF0gDQogICAgICAgICAgICBXcml0ZS1Ib3N0ICgoJFZlcjg2IC1zcGxpdCAnW1xyXScpWzBdKQ0KICAgICAgICB9DQogICAgfQ0KICAgIEZpbmFsbHkNCiAgICB7DQogICAgICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiQ29udGludWUiOyAjUmVzZXQgdGhlIGVycm9yIGFjdGlvbiBwcmVmIHRvIGRlZmF1bHQNCiAgICB9DQoNCiAgICAjIENIRUNLIElGIE9VVExPT0sgV0FTIEZPVU5EIEFOWVdIRVJFDQogICAgSUYgKChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNFxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNlxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNFxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNlxPVVRMT09LLkVYRSIpKQ0KICAgICAgICB7fQ0KICAgICAgICBFbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIHtXcml0ZS1Ib3N0ICdDb21wbGlhbnQnfQ0KICAgICAgICB9DQoNCn0NCkNhdGNoDQp7DQogICAgSWYgKCRfLkV4Y2VwdGlvbi5FcnJvckNvZGUgLWVxICIweDgwMDcwNkJBIikNCiAgICB7DQogICAgICAgIFdyaXRlLUhvc3QgJ1dNSV8tX1JQQ19TZXJ2ZXJfVW5hdmFpbGFibGUnDQogICAgfQ0KICAgIEVsc2VJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzAwMDUiKQ0KICAgIHsNCiAgICAgICAgV3JpdGUtSG9zdCAnV01JXy1fQWNjZXNzX2lzX0RlbmllZCcNCiAgICB9DQogICAgRWxzZQ0KICAgIHsNCiAgICAgICAgW3N0cmluZ10kVmVyODYgPSAkZXJyb3JbMF0gDQogICAgICAgIFdyaXRlLUhvc3QgKCgkVmVyODYgLXNwbGl0ICdbXHJdJylbMF0pDQogICAgfQ0KfQ0KRmluYWxseQ0Kew0KICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiQ29udGludWUiOyAjUmVzZXQgdGhlIGVycm9yIGFjdGlvbiBwcmVmIHRvIGRlZmF1bHQNCn0NCg== # ENCODEDSCRIPT# End Configuration Manager encoded script block
$RegKey1 = "IPM.Note.EnterpriseVault.PendingArchive"

# ENCODEDSCRIPT # Begin Configuration Manager encoded script block # 77u/JFJlZ0tleTEgPSAiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlBlbmRpbmdBcmNoaXZlIg0KJFJlZ0tleTIgPSAiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlBlbmRpbmdBcmNoaXZlLkFyY2hpdmVNZSINCiRSZWdLZXkzID0gIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dC5EZWxldGVNZSINCiRSZWdLZXk0ID0gIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dC5SZXN0b3JlTWUiDQokUmVnS2V5NSA9ICJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQiDQokUmVnS2V5NiA9ICJEaXNhYmxlQ3VzdG9tRm9ybUl0ZW1TY3JpcHQiDQokUmVnS2V5NyA9ICJFbmFibGVSb2FtaW5nRm9sZGVySG9tZXBhZ2VzIg0KDQoNCiRSZWdUeXBlMSA9ICJTVFJJTkciDQokUmVnVHlwZTIgPSAiRFdPUkQiDQoNCiRSZWdWYWx1ZTEgPSAiIg0KJFJlZ1ZhbHVlMiA9ICIwIg0KJFJlZ1ZhbHVlMyA9ICIxIg0KDQpGdW5jdGlvbiBDaGVja1JlZyAoJFJlZ1BhdGgsJFJlZ1BhdGgyLCAkUmVnUGF0aDMpDQp7DQogICAgJFJlZzEgPSBHZXQtSXRlbVByb3BlcnR5ICRSZWdQYXRoMSAtTmFtZSAkUmVnS2V5MQ0KICAgICRSZWcyID0gR2V0LUl0ZW1Qcm9wZXJ0eSAkUmVnUGF0aDEgLU5hbWUgJFJlZ0tleTINCiAgICAkUmVnMyA9IEdlXX1JdGVtUHJvcGVydHkgJFJlZ1BhdGgxIC1OYW1lICRSZWdLZXkzDQogICAgJFJlZzQgPSBHZXQtSXRlbVByb3BlcnR5ICRSZWdQYXRoMSAtTmFtZSAkUmVnS2V5NA0KICAgICRSZWc1ID0gR2V0LUl0ZW1Qcm9wZXJ0eSAkUmVnUGF0aDEgLU5hbWUgJFJlZ0tleTUNCiAgICAkUmVnNiA9IEdlXX1JdGVtUHJvcGVydHkgJFJlZ1BhdGgyIC1OYW1lICRSZWdLZXk2DQogICAgJFJlZzcgPSBHZXQtSXRlbVByb3BlcnR5ICRSZWdQYXRoMyAtTmFtZSAkUmVnS2V5Nw0KICAgIA0KICAgIElmICgoJFJlZzEuIklQTWAuTm90ZS5FbnRlcnByaXNlVmF1bHRgLlBlbmRpbmdBcmNoaXZlIiDigJNlcSAnJykgLWFuZCBgDQogICAgCSgkUmVnMi4iSVBNYC5Ob3RlLkVudGVycHJpc2VWYXVsdGAuUGVuZGluZ0FyY2hpdmUuQXJjaGl2ZU1lIiDigJNlcSAnJykgLWFuZCBgDQogICAgCSgkUmVnMy4iSVBNYC5Ob3RlLkVudGVycHJpc2VWYXVsdGAuU2hvcnRjdXQuRGVsZXRlTWUiIOKAk2VxICcnKSAtYW5kIGANCiAgICAJKCRSZWc0LiJJUE1gLk5vdGUuRW50ZXJwcmlzZVZhdWx0YC5TaG9ydGN1dC5SZXN0b3JlTWUiIOKAk2VxICcnKSAtYW5kIGANCiAgICAJKCRSZWc1LiJJUE1gLk5vdGUuRW50ZXJwcmlzZVZhdWx0YC5TaG9ydGN1dCIg4oCTZXEgJycpIC1hbmQgYA0KICAgIAkoJFJlZzYuIkRpc2FibGVDdXN0b21Gb3JtSXRlbVNjcmlwdCIg4oCTZXEgJzAnKSAtYW5kIGANCiAgICAJKCRSZWc3LiJFbmFibGVSb2FtaW5nRm9sZGVySG9tZXBhZ2VzIiDigJNlcSAnMScpDQogICAgCSkNCiAgICAJe1dyaXRlLUhvc3QgJ0NvbXBsaWFudCd9DQogICAgRWxzZXtXcml0ZS1Ib3N0ICdOb24tQ29tcGxpYW50J30NCn0NCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMgQ2hlY2sgT1MgVHlwZQ0KVHJ5DQp7DQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTdG9wIjsgI01ha2UgYWxsIGVycm9ycyB0ZXJtaW5hdGluZw0KICAgICRTeXN0ZW0gPSBnd21pIFdpbjMyX0NvbXB1dGVyU3lzdGVtICMgbm9ybWFsbHkgbm9uLXRlcm1pbmF0aW5nDQogICAgJFR5cGUgPSAkU3lzdGVtLlN5c3RlbVR5cGUNCg0KICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgICMgQ2hlY2sgT3V0bG9vay5leGUgVmVyc2lvbg0KICAgIFRyeQ0KICAgIHsNCiAgICAgICAgIyAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1NpbGVudGx5Q29udGludWUnDQogICAgICAgICRSZWcgPSBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5XTo6T3BlbkJhc2VLZXkoJ0xvY2FsTWFjaGluZScsICdkZWZhdWx0JykNCiAgICAgICAgJFJlZzIgPSBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5XTo6T3BlbkJhc2VLZXkoJ0N1cnJlbnRVc2VyJywgJ2RlZmF1bHQnKQ0KDQogICAgICAgIElGICgkVHlwZSAtZXEgJ3g2NC1iYXNlZCBQQycpDQogICAgICAgIHsNCiAgICAgICAgICAgIElGIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNFxPVVRMT09LLkVYRSIpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgJFJlZ1BhdGgxID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xPdXRsb29rXFNlY3VyaXR5Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xPdXRsb29rXFNlY3VyaXR5Ig0KICAgICAgICAgICAgICAgIENoZWNrUmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTRcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTVcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KCQkJCSRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiSEtMTTpcU09GVFdBUkVcV09XNjQzMk5vZGVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJIS0xNOlxTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCQkkUmVnUGF0aDMgPSAiSEtDVTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgQ2hlY2tSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIEVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCgkJCQkkUmVnUGF0aDEgPSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNC4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KCQkJCSRSZWdQYXRoMiA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCQkkUmVnUGF0aDMgPSAiSEtDVTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNC4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgQ2hlY2tSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIElGIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpDQogICAgICAgICAgICB7DQoJCQkgICAgJFJlZ1BhdGgxID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXEZvcm1zXFRydXN0ZWRGb3JtU2NyaXB0TGlzdCINCgkJCSAgICAkUmVnUGF0aDIgPSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQoJCQkJJFJlZ1BhdGgzID0gIkhLQ1U6XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJICAgIENoZWNrUmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCSAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIENhdGNoDQogICAgew0KICAgICAgICBJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzA2QkEiKQ0KICAgICAgICB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICdXTUlfLV9SUENfU2VydmVyX1VuYXZhaWxhYmxlJw0KICAgICAgICB9DQogICAgICAgIEVsc2VJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzAwMDUiKQ0KICAgICAgICB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICdXTUlfLV9BY2Nlc3NfaXNfRGVuaWVkJw0KICAgICAgICB9DQogICAgICAgIEVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgW3N0cmluZ10kVmVyODYgPSAkZXJyb3JbMF0gDQogICAgICAgICAgICBXcml0ZS1Ib3N0ICgoJFZlcjg2IC1zcGxpdCAnW1xyXScpWzBdKQ0KICAgICAgICB9DQogICAgfQ0KICAgIEZpbmFsbHkNCiAgICB7DQogICAgICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiQ29udGludWUiOyAjUmVzZXQgdGhlIGVycm9yIGFjdGlvbiBwcmVmIHRvIGRlZmF1bHQNCiAgICB9DQoNCiAgICAjIENIRUNLIElGIE9VVExPT0sgV0FTIEZPVU5EIEFOWVdIRVJFDQogICAgSUYgKChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNFxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNlxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNFxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNlxPVVRMT09LLkVYRSIpKQ0KICAgICAgICB7fQ0KICAgICAgICBFbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIHtXcml0ZS1Ib3N0ICdDb21wbGlhbnQnfQ0KICAgICAgICB9DQoNCn0NCkNhdGNoDQp7DQogICAgSWYgKCRfLkV4Y2VwdGlvbi5FcnJvckNvZGUgLWVxICIweDgwMDcwNkJBIikNCiAgICB7DQogICAgICAgIFdyaXRlLUhvc3QgJ1dNSV8tX1JQQ19TZXJ2ZXJfVW5hdmFpbGFibGUnDQogICAgfQ0KICAgIEVsc2VJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzAwMDUiKQ0KICAgIHsNCiAgICAgICAgV3JpdGUtSG9zdCAnV01JXy1fQWNjZXNzX2lzX0RlbmllZCcNCiAgICB9DQogICAgRWxzZQ0KICAgIHsNCiAgICAgICAgW3N0cmluZ10kVmVyODYgPSAkZXJyb3JbMF0gDQogICAgICAgIFdyaXRlLUhvc3QgKCgkVmVyODYgLXNwbGl0ICdbXHJdJylbMF0pDQogICAgfQ0KfQ0KRmluYWxseQ0Kew0KICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiQ29udGludWUiOyAjUmVzZXQgdGhlIGVycm9yIGFjdGlvbiBwcmVmIHRvIGRlZmF1bHQNCn0NCg== # ENCODEDSCRIPT# End Configuration Manager encoded script block
$RegKey1 = "IPM.Note.EnterpriseVault.PendingArchive"
$RegKey2 = "IPM.Note.EnterpriseVault.PendingArchive.ArchiveMe"
$RegKey3 = "IPM.Note.EnterpriseVault.Shortcut.DeleteMe"
$RegKey4 = "IPM.Note.EnterpriseVault.Shortcut.RestoreMe"
$RegKey5 = "IPM.Note.EnterpriseVault.Shortcut"
$RegKey6 = "DisableCustomFormItemScript"
$RegKey7 = "EnableRoamingFolderHomepages"


$RegType1 = "STRING"
$RegType2 = "DWORD"

$RegValue1 = ""
$RegValue2 = "0"
$RegValue3 = "1"

Function CheckReg ($RegPath,$RegPath2, $RegPath3)
{
    $Reg1 = Get-ItemProperty $RegPath1 -Name $RegKey1
    $Reg2 = Get-ItemProperty $RegPath1 -Name $RegKey2
    $Reg3 = Get-ItemProperty $RegPath1 -Name $RegKey3
    $Reg4 = Get-ItemProperty $RegPath1 -Name $RegKey4
    $Reg5 = Get-ItemProperty $RegPath1 -Name $RegKey5
    $Reg6 = Get-ItemProperty $RegPath2 -Name $RegKey6
    $Reg7 = Get-ItemProperty $RegPath3 -Name $RegKey7
    
    If (($Reg1."IPM`.Note.EnterpriseVault`.PendingArchive" –eq '') -and `
    	($Reg2."IPM`.Note.EnterpriseVault`.PendingArchive.ArchiveMe" –eq '') -and `
    	($Reg3."IPM`.Note.EnterpriseVault`.Shortcut.DeleteMe" –eq '') -and `
    	($Reg4."IPM`.Note.EnterpriseVault`.Shortcut.RestoreMe" –eq '') -and `
    	($Reg5."IPM`.Note.EnterpriseVault`.Shortcut" –eq '') -and `
    	($Reg6."DisableCustomFormItemScript" –eq '0') -and `
    	($Reg7."EnableRoamingFolderHomepages" –eq '1')
    	)
    	{Write-Host 'Compliant'}
    Else{Write-Host 'Non-Compliant'}
}


##########################################################################################################################################
# Check OS Type
Try
{
    $ErrorActionPreference = "Stop"; #Make all errors terminating
    $System = gwmi Win32_ComputerSystem # normally non-terminating
    $Type = $System.SystemType

    ##########################################################################################################################################
    # Check Outlook.exe Version
    Try
    {
        # $ErrorActionPreference = 'SilentlyContinue'
        $Reg = [Microsoft.Win32.RegistryKey]::OpenBaseKey('LocalMachine', 'default')
        $Reg2 = [Microsoft.Win32.RegistryKey]::OpenBaseKey('CurrentUser', 'default')

        IF ($Type -eq 'x64-based PC')
        {
            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office14\OUTLOOK.EXE")
            {
                $RegPath1 = "HKLM:\SOFTWARE\Microsoft\Office\14.0\Outlook\Outlook\Forms\TrustedFormScriptList"
                $RegPath2 = "HKLM:\SOFTWARE\Microsoft\Office\14.0\Outlook\Outlook\Security"
                $RegPath3 = "HKCU:\SOFTWARE\Microsoft\Office\14.0\Outlook\Outlook\Security"
                CheckReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
            IF (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office14\OUTLOOK.EXE")
            {
                $RegPath1 = "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Office\14.0\Outlook\Forms\TrustedFormScriptList"
				$RegPath2 = "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Office\14.0\Outlook\Security"
				$RegPath3 = "HKCU:\SOFTWARE\Microsoft\Office\14.0\Outlook\Security"
                CheckReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }

            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office15\OUTLOOK.EXE")
            {
				$RegPath1 = "HKLM:\SOFTWARE\Microsoft\Office\15.0\Outlook\Forms\TrustedFormScriptList"
				$RegPath2 = "HKLM:\SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
				$RegPath3 = "HKCU:\SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
                CheckReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
            IF (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office15\OUTLOOK.EXE")
            {
                $RegPath1 = "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\Outlook\Forms\TrustedFormScriptList"
                $RegPath2 = "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Office\15.0\Outlook\Security"
				$RegPath3 = "HKCU:\SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
                CheckReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }


            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office16\OUTLOOK.EXE")
            {
                $RegPath1 = "HKLM:\SOFTWARE\Microsoft\Office\16.0\Outlook\Forms\TrustedFormScriptList"
				$RegPath2 = "HKLM:\SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
				$RegPath3 = "HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
                CheckReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3

            }
            IF (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office16\OUTLOOK.EXE")
            {
                $RegPath1 = "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Outlook\Forms\TrustedFormScriptList"
                $RegPath2 = "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Outlook\Security"
				$RegPath3 = "HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
                CheckReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
        }
        Else
        {
            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office14\OUTLOOK.EXE")
            {
				$RegPath1 = "HKLM:\SOFTWARE\Microsoft\Office\14.0\Outlook\Forms\TrustedFormScriptList"
				$RegPath2 = "HKLM:\SOFTWARE\Microsoft\Office\14.0\Outlook\Security"
				$RegPath3 = "HKCU:\SOFTWARE\Microsoft\Office\14.0\Outlook\Security"
                CheckReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office15\OUTLOOK.EXE")
            {
			    $RegPath1 = "HKLM:\SOFTWARE\Microsoft\Office\15.0\Outlook\Forms\TrustedFormScriptList"
			    $RegPath2 = "HKLM:\SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
				$RegPath3 = "HKCU:\SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
			    CheckReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office16\OUTLOOK.EXE")
            {
                $RegPath1 = "HKLM:\SOFTWARE\Microsoft\Office\16.0\Outlook\Forms\TrustedFormScriptList"
                $RegPath2 = "HKLM:\SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
				$RegPath3 = "HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
			    CheckReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
        }
    }
    Catch
    {
        If ($_.Exception.ErrorCode -eq "0x800706BA")
        {
            Write-Host 'WMI_-_RPC_Server_Unavailable'
        }
        ElseIf ($_.Exception.ErrorCode -eq "0x80070005")
        {
            Write-Host 'WMI_-_Access_is_Denied'
        }
        Else
        {
            [string]$Ver86 = $error[0] 
            Write-Host (($Ver86 -split '[\r]')[0])
        }
    }
    Finally
    {
        $ErrorActionPreference = "Continue"; #Reset the error action pref to default
    }

    # CHECK IF OUTLOOK WAS FOUND ANYWHERE
    IF ((Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office14\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office15\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office16\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files\Microsoft Office\Office14\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files\Microsoft Office\Office15\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files\Microsoft Office\Office16\OUTLOOK.EXE"))
        {}
        Else
        {
            {Write-Host 'Compliant'}
        }

}
Catch
{
    If ($_.Exception.ErrorCode -eq "0x800706BA")
    {
        Write-Host 'WMI_-_RPC_Server_Unavailable'
    }
    ElseIf ($_.Exception.ErrorCode -eq "0x80070005")
    {
        Write-Host 'WMI_-_Access_is_Denied'
    }
    Else
    {
        [string]$Ver86 = $error[0] 
        Write-Host (($Ver86 -split '[\r]')[0])
    }
}
Finally
{
    $ErrorActionPreference = "Continue"; #Reset the error action pref to default
}


# ENCODEDSCRIPT # Begin Configuration Manager encoded script block # 77u/JFJlZ0tleTEgPSAiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlBlbmRpbmdBcmNoaXZlIg0KJFJlZ0tleTIgPSAiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlBlbmRpbmdBcmNoaXZlLkFyY2hpdmVNZSINCiRSZWdLZXkzID0gIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dC5EZWxldGVNZSINCiRSZWdLZXk0ID0gIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dC5SZXN0b3JlTWUiDQokUmVnS2V5NSA9ICJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQiDQokUmVnS2V5NiA9ICJEaXNhYmxlQ3VzdG9tRm9ybUl0ZW1TY3JpcHQiDQokUmVnS2V5NyA9ICJFbmFibGVSb2FtaW5nRm9sZGVySG9tZXBhZ2VzIg0KDQoNCiRSZWdUeXBlMSA9ICJTVFJJTkciDQokUmVnVHlwZTIgPSAiRFdPUkQiDQoNCiRSZWdWYWx1ZTEgPSAiIg0KJFJlZ1ZhbHVlMiA9ICIwIg0KJFJlZ1ZhbHVlMyA9ICIxIg0KDQpGdW5jdGlvbiBDaGVja1JlZyAoJFJlZ1BhdGgsJFJlZ1BhdGgyLCAkUmVnUGF0aDMpDQp7DQogICAgJFJlZzEgPSBHZXQtSXRlbVByb3BlcnR5ICRSZWdQYXRoMSAtTmFtZSAkUmVnS2V5MQ0KICAgICRSZWcyID0gR2V0LUl0ZW1Qcm9wZXJ0eSAkUmVnUGF0aDEgLU5hbWUgJFJlZ0tleTINCiAgICAkUmVnMyA9IEdlXX1JdGVtUHJvcGVydHkgJFJlZ1BhdGgxIC1OYW1lICRSZWdLZXkzDQogICAgJFJlZzQgPSBHZXQtSXRlbVByb3BlcnR5ICRSZWdQYXRoMSAtTmFtZSAkUmVnS2V5NA0KICAgICRSZWc1ID0gR2V0LUl0ZW1Qcm9wZXJ0eSAkUmVnUGF0aDEgLU5hbWUgJFJlZ0tleTUNCiAgICAkUmVnNiA9IEdlXX1JdGVtUHJvcGVydHkgJFJlZ1BhdGgyIC1OYW1lICRSZWdLZXk2DQogICAgJFJlZzcgPSBHZXQtSXRlbVByb3BlcnR5ICRSZWdQYXRoMyAtTmFtZSAkUmVnS2V5Nw0KICAgIA0KICAgIElmICgoJFJlZzEuIklQTWAuTm90ZS5FbnRlcnByaXNlVmF1bHRgLlBlbmRpbmdBcmNoaXZlIiDigJNlcSAnJykgLWFuZCBgDQogICAgCSgkUmVnMi4iSVBNYC5Ob3RlLkVudGVycHJpc2VWYXVsdGAuUGVuZGluZ0FyY2hpdmUuQXJjaGl2ZU1lIiDigJNlcSAnJykgLWFuZCBgDQogICAgCSgkUmVnMy4iSVBNYC5Ob3RlLkVudGVycHJpc2VWYXVsdGAuU2hvcnRjdXQuRGVsZXRlTWUiIOKAk2VxICcnKSAtYW5kIGANCiAgICAJKCRSZWc0LiJJUE1gLk5vdGUuRW50ZXJwcmlzZVZhdWx0YC5TaG9ydGN1dC5SZXN0b3JlTWUiIOKAk2VxICcnKSAtYW5kIGANCiAgICAJKCRSZWc1LiJJUE1gLk5vdGUuRW50ZXJwcmlzZVZhdWx0YC5TaG9ydGN1dCIg4oCTZXEgJycpIC1hbmQgYA0KICAgIAkoJFJlZzYuIkRpc2FibGVDdXN0b21Gb3JtSXRlbVNjcmlwdCIg4oCTZXEgJzAnKSAtYW5kIGANCiAgICAJKCRSZWc3LiJFbmFibGVSb2FtaW5nRm9sZGVySG9tZXBhZ2VzIiDigJNlcSAnMScpDQogICAgCSkNCiAgICAJe1dyaXRlLUhvc3QgJ0NvbXBsaWFudCd9DQogICAgRWxzZXtXcml0ZS1Ib3N0ICdOb24tQ29tcGxpYW50J30NCn0NCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMgQ2hlY2sgT1MgVHlwZQ0KVHJ5DQp7DQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTdG9wIjsgI01ha2UgYWxsIGVycm9ycyB0ZXJtaW5hdGluZw0KICAgICRTeXN0ZW0gPSBnd21pIFdpbjMyX0NvbXB1dGVyU3lzdGVtICMgbm9ybWFsbHkgbm9uLXRlcm1pbmF0aW5nDQogICAgJFR5cGUgPSAkU3lzdGVtLlN5c3RlbVR5cGUNCg0KICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KICAgICMgQ2hlY2sgT3V0bG9vay5leGUgVmVyc2lvbg0KICAgIFRyeQ0KICAgIHsNCiAgICAgICAgIyAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1NpbGVudGx5Q29udGludWUnDQogICAgICAgICRSZWcgPSBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5XTo6T3BlbkJhc2VLZXkoJ0xvY2FsTWFjaGluZScsICdkZWZhdWx0JykNCiAgICAgICAgJFJlZzIgPSBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5XTo6T3BlbkJhc2VLZXkoJ0N1cnJlbnRVc2VyJywgJ2RlZmF1bHQnKQ0KDQogICAgICAgIElGICgkVHlwZSAtZXEgJ3g2NC1iYXNlZCBQQycpDQogICAgICAgIHsNCiAgICAgICAgICAgIElGIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNFxPVVRMT09LLkVYRSIpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgJFJlZ1BhdGgxID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xPdXRsb29rXFNlY3VyaXR5Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xPdXRsb29rXFNlY3VyaXR5Ig0KICAgICAgICAgICAgICAgIENoZWNrUmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTRcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTVcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KCQkJCSRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiSEtMTTpcU09GVFdBUkVcV09XNjQzMk5vZGVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJIS0xNOlxTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCQkkUmVnUGF0aDMgPSAiSEtDVTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgQ2hlY2tSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIEVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCgkJCQkkUmVnUGF0aDEgPSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNC4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KCQkJCSRSZWdQYXRoMiA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCQkkUmVnUGF0aDMgPSAiSEtDVTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNC4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgQ2hlY2tSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIElGIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpDQogICAgICAgICAgICB7DQoJCQkgICAgJFJlZ1BhdGgxID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXEZvcm1zXFRydXN0ZWRGb3JtU2NyaXB0TGlzdCINCgkJCSAgICAkUmVnUGF0aDIgPSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQoJCQkJJFJlZ1BhdGgzID0gIkhLQ1U6XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJICAgIENoZWNrUmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCSAgICBDaGVja1JlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIENhdGNoDQogICAgew0KICAgICAgICBJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzA2QkEiKQ0KICAgICAgICB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICdXTUlfLV9SUENfU2VydmVyX1VuYXZhaWxhYmxlJw0KICAgICAgICB9DQogICAgICAgIEVsc2VJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzAwMDUiKQ0KICAgICAgICB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICdXTUlfLV9BY2Nlc3NfaXNfRGVuaWVkJw0KICAgICAgICB9DQogICAgICAgIEVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgW3N0cmluZ10kVmVyODYgPSAkZXJyb3JbMF0gDQogICAgICAgICAgICBXcml0ZS1Ib3N0ICgoJFZlcjg2IC1zcGxpdCAnW1xyXScpWzBdKQ0KICAgICAgICB9DQogICAgfQ0KICAgIEZpbmFsbHkNCiAgICB7DQogICAgICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiQ29udGludWUiOyAjUmVzZXQgdGhlIGVycm9yIGFjdGlvbiBwcmVmIHRvIGRlZmF1bHQNCiAgICB9DQoNCiAgICAjIENIRUNLIElGIE9VVExPT0sgV0FTIEZPVU5EIEFOWVdIRVJFDQogICAgSUYgKChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNFxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNlxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNFxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpIC1vciBgDQogICAgICAgIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNlxPVVRMT09LLkVYRSIpKQ0KICAgICAgICB7fQ0KICAgICAgICBFbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIHtXcml0ZS1Ib3N0ICdDb21wbGlhbnQnfQ0KICAgICAgICB9DQoNCn0NCkNhdGNoDQp7DQogICAgSWYgKCRfLkV4Y2VwdGlvbi5FcnJvckNvZGUgLWVxICIweDgwMDcwNkJBIikNCiAgICB7DQogICAgICAgIFdyaXRlLUhvc3QgJ1dNSV8tX1JQQ19TZXJ2ZXJfVW5hdmFpbGFibGUnDQogICAgfQ0KICAgIEVsc2VJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzAwMDUiKQ0KICAgIHsNCiAgICAgICAgV3JpdGUtSG9zdCAnV01JXy1fQWNjZXNzX2lzX0RlbmllZCcNCiAgICB9DQogICAgRWxzZQ0KICAgIHsNCiAgICAgICAgW3N0cmluZ10kVmVyODYgPSAkZXJyb3JbMF0gDQogICAgICAgIFdyaXRlLUhvc3QgKCgkVmVyODYgLXNwbGl0ICdbXHJdJylbMF0pDQogICAgfQ0KfQ0KRmluYWxseQ0Kew0KICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiQ29udGludWUiOyAjUmVzZXQgdGhlIGVycm9yIGFjdGlvbiBwcmVmIHRvIGRlZmF1bHQNCn0NCg== # ENCODEDSCRIPT# End Configuration Manager encoded script block

