Function SetReg ($RegPath1,$RegPath2,$RegPath3)

# ENCODEDSCRIPT # Begin Configuration Manager encoded script block # 77u/RnVuY3Rpb24gU2V0UmVnICgkUmVnUGF0aDEsJFJlZ1BhdGgyLCRSZWdQYXRoMykNCnsNCgkkUmVnS2V5MSA9ICRSZWcuT3BlblN1YktleSgkUmVnUGF0aDEpDQoJSWYgKCRSZWdLZXkxIC1lcSAkbnVsbCkNCgl7DQoJCSRSZWcuQ3JlYXRlU3ViS2V5KCIkUmVnUGF0aDEiKQ0KCQkkUmVnS2V5MSA9ICRSZWcuT3BlblN1YktleSgiJFJlZ1BhdGgxIiwkdHJ1ZSkNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuUGVuZGluZ0FyY2hpdmUiLCIiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpTdHJpbmcpDQogICAgICAgICAkUmVnS2V5MS5TZXRWYWx1ZSgiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlBlbmRpbmdBcmNoaXZlLkFyY2hpdmVNZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQuRGVsZXRlTWUiLCIiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpTdHJpbmcpDQogICAgICAgICAkUmVnS2V5MS5TZXRWYWx1ZSgiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlNob3J0Y3V0LlJlc3RvcmVNZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQiLCIiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpTdHJpbmcpDQoJfQ0KCUVsc2UNCgl7DQoJCSRSZWdLZXkxID0gJFJlZy5PcGVuU3ViS2V5KCIkUmVnUGF0aDEiLCR0cnVlKQ0KICAgICAgICAgJFJlZ0tleTEuU2V0VmFsdWUoIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5QZW5kaW5nQXJjaGl2ZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuUGVuZGluZ0FyY2hpdmUuQXJjaGl2ZU1lIiwiIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6U3RyaW5nKQ0KICAgICAgICAgJFJlZ0tleTEuU2V0VmFsdWUoIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dC5EZWxldGVNZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQuUmVzdG9yZU1lIiwiIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6U3RyaW5nKQ0KICAgICAgICAgJFJlZ0tleTEuU2V0VmFsdWUoIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dCIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCgl9DQoNCgkkUmVnS2V5MiA9ICRSZWcuT3BlblN1YktleSgkUmVnUGF0aDIpDQoJSWYgKCRSZWdLZXkyIC1lcSAkbnVsbCkNCgl7DQoJCSRSZWcuQ3JlYXRlU3ViS2V5KCIkUmVnUGF0aDIiKQ0KIAkgICAgJFJlZ0tleTIgPSAkUmVnLk9wZW5TdWJLZXkoIiRSZWdQYXRoMiIsJHRydWUpDQogICAgICAgICRSZWdLZXkyLlNldFZhbHVlKCJEaXNhYmxlQ3VzdG9tRm9ybUl0ZW1TY3JpcHQiLCIwIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6RFdPUkQpDQoJfQ0KCUVsc2UNCiAgICB7DQogICAgICAgICRSZWdLZXkyID0gJFJlZy5PcGVuU3ViS2V5KCIkUmVnUGF0aDIiLCR0cnVlKQ0KICAgICAgICAgICRSZWdLZXkyLlNldFZhbHVlKCJEaXNhYmxlQ3VzdG9tRm9ybUl0ZW1TY3JpcHQiLCIwIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6RFdPUkQpDQogICAgfQ0KDQoJJFJlZ0tleTMgPSAkUmVnMi5PcGVuU3ViS2V5KCRSZWdQYXRoMykNCglJZiAoJFJlZ0tleTMgLWVxICRudWxsKQ0KCXsNCgkJJFJlZzIuQ3JlYXRlU3ViS2V5KCIkUmVnUGF0aDMiKQ0KIAkgICAgJFJlZ0tleTMgPSAkUmVnMi5PcGVuU3ViS2V5KCIkUmVnUGF0aDMiLCR0cnVlKQ0KICAgICAgICAkUmVnS2V5My5TZXRWYWx1ZSgiRW5hYmxlUm9hbWluZ0ZvbGRlckhvbWVwYWdlcyIsIjEiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpEV09SRCkNCgl9DQoJRWxzZQ0KICAgIHsNCiAgICAgICAgJFJlZ0tleTMgPSAkUmVnMi5PcGVuU3ViS2V5KCIkUmVnUGF0aDMiLCR0cnVlKQ0KICAgICAgICAkUmVnS2V5My5TZXRWYWx1ZSgiRW5hYmxlUm9hbWluZ0ZvbGRlckhvbWVwYWdlcyIsIjEiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpEV09SRCkNCiAgICB9DQp9DQoNCg0KDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyBDaGVjayBPUyBUeXBlDQpUcnkNCnsNCiAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gIlN0b3AiOyAjTWFrZSBhbGwgZXJyb3JzIHRlcm1pbmF0aW5nDQogICAgJFN5c3RlbSA9IGd3bWkgV2luMzJfQ29tcHV0ZXJTeXN0ZW0gIyBub3JtYWxseSBub24tdGVybWluYXRpbmcNCiAgICAkVHlwZSA9ICRTeXN0ZW0uU3lzdGVtVHlwZQ0KDQogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQogICAgIyBDaGVjayBPdXRsb29rLmV4ZSBWZXJzaW9uDQogICAgVHJ5DQogICAgew0KICAgICAgICAjICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScNCiAgICAgICAgJFJlZyA9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXldOjpPcGVuQmFzZUtleSgnTG9jYWxNYWNoaW5lJywgJ2RlZmF1bHQnKQ0KICAgICAgICAkUmVnMiA9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXldOjpPcGVuQmFzZUtleSgnQ3VycmVudFVzZXInLCAnZGVmYXVsdCcpDQoNCiAgICAgICAgSUYgKCRUeXBlIC1lcSAneDY0LWJhc2VkIFBDJykNCiAgICAgICAgew0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNC4wXE91dGxvb2tcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgzID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTRcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIlNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCgkJCQkkUmVnUGF0aDEgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KCQkJCSRSZWdQYXRoMiA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCQkkUmVnUGF0aDMgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTVcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIlNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiU09GVFdBUkVcV09XNjQzMk5vZGVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICAkUmVnUGF0aDMgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgRWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTRcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KCQkJCSRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIElGIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpDQogICAgICAgICAgICB7DQoJCQkgICAgJFJlZ1BhdGgxID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXEZvcm1zXFRydXN0ZWRGb3JtU2NyaXB0TGlzdCINCgkJCSAgICAkUmVnUGF0aDIgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQoJCQkgICAgJFJlZ1BhdGgzID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJICAgIFNldFJlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICAkUmVnUGF0aDMgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcU2VjdXJpdHkiDQoJCQkgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgQ2F0Y2gNCiAgICB7DQogICAgICAgIElmICgkXy5FeGNlcHRpb24uRXJyb3JDb2RlIC1lcSAiMHg4MDA3MDZCQSIpDQogICAgICAgIHsNCiAgICAgICAgICAgIFdyaXRlLUhvc3QgJ1dNSV8tX1JQQ19TZXJ2ZXJfVW5hdmFpbGFibGUnDQogICAgICAgIH0NCiAgICAgICAgRWxzZUlmICgkXy5FeGNlcHRpb24uRXJyb3JDb2RlIC1lcSAiMHg4MDA3MDAwNSIpDQogICAgICAgIHsNCiAgICAgICAgICAgIFdyaXRlLUhvc3QgJ1dNSV8tX0FjY2Vzc19pc19EZW5pZWQnDQogICAgICAgIH0NCiAgICAgICAgRWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBbc3RyaW5nXSRWZXI4NiA9ICRlcnJvclswXSANCiAgICAgICAgICAgIFdyaXRlLUhvc3QgKCgkVmVyODYgLXNwbGl0ICdbXHJdJylbMF0pDQogICAgICAgIH0NCiAgICB9DQogICAgRmluYWxseQ0KICAgIHsNCiAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJDb250aW51ZSI7ICNSZXNldCB0aGUgZXJyb3IgYWN0aW9uIHByZWYgdG8gZGVmYXVsdA0KICAgIH0NCg0KICAgICMgQ0hFQ0sgSUYgT1VUTE9PSyBXQVMgRk9VTkQgQU5ZV0hFUkUNCiAgICBJRiAoKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikpDQogICAgICAgIHt9DQogICAgICAgIEVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAge1dyaXRlLUhvc3QgJ0NvbXBsaWFudCd9DQogICAgICAgIH0NCg0KfQ0KQ2F0Y2gNCnsNCiAgICBJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzA2QkEiKQ0KICAgIHsNCiAgICAgICAgV3JpdGUtSG9zdCAnV01JXy1fUlBDX1NlcnZlcl9VbmF2YWlsYWJsZScNCiAgICB9DQogICAgRWxzZUlmICgkXy5FeGNlcHRpb24uRXJyb3JDb2RlIC1lcSAiMHg4MDA3MDAwNSIpDQogICAgew0KICAgICAgICBXcml0ZS1Ib3N0ICdXTUlfLV9BY2Nlc3NfaXNfRGVuaWVkJw0KICAgIH0NCiAgICBFbHNlDQogICAgew0KICAgICAgICBbc3RyaW5nXSRWZXI4NiA9ICRlcnJvclswXSANCiAgICAgICAgV3JpdGUtSG9zdCAoKCRWZXI4NiAtc3BsaXQgJ1tccl0nKVswXSkNCiAgICB9DQp9DQpGaW5hbGx5DQp7DQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJDb250aW51ZSI7ICNSZXNldCB0aGUgZXJyb3IgYWN0aW9uIHByZWYgdG8gZGVmYXVsdA0KfQ0K # ENCODEDSCRIPT# End Configuration Manager encoded script block
Function SetReg ($RegPath1,$RegPath2,$RegPath3)

# ENCODEDSCRIPT # Begin Configuration Manager encoded script block # 77u/RnVuY3Rpb24gU2V0UmVnICgkUmVnUGF0aDEsJFJlZ1BhdGgyLCRSZWdQYXRoMykNCnsNCgkkUmVnS2V5MSA9ICRSZWcuT3BlblN1YktleSgkUmVnUGF0aDEpDQoJSWYgKCRSZWdLZXkxIC1lcSAkbnVsbCkNCgl7DQoJCSRSZWcuQ3JlYXRlU3ViS2V5KCIkUmVnUGF0aDEiKQ0KCQkkUmVnS2V5MSA9ICRSZWcuT3BlblN1YktleSgiJFJlZ1BhdGgxIiwkdHJ1ZSkNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuUGVuZGluZ0FyY2hpdmUiLCIiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpTdHJpbmcpDQogICAgICAgICAkUmVnS2V5MS5TZXRWYWx1ZSgiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlBlbmRpbmdBcmNoaXZlLkFyY2hpdmVNZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQuRGVsZXRlTWUiLCIiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpTdHJpbmcpDQogICAgICAgICAkUmVnS2V5MS5TZXRWYWx1ZSgiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlNob3J0Y3V0LlJlc3RvcmVNZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQiLCIiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpTdHJpbmcpDQoJfQ0KCUVsc2UNCgl7DQoJCSRSZWdLZXkxID0gJFJlZy5PcGVuU3ViS2V5KCIkUmVnUGF0aDEiLCR0cnVlKQ0KICAgICAgICAgJFJlZ0tleTEuU2V0VmFsdWUoIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5QZW5kaW5nQXJjaGl2ZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuUGVuZGluZ0FyY2hpdmUuQXJjaGl2ZU1lIiwiIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6U3RyaW5nKQ0KICAgICAgICAgJFJlZ0tleTEuU2V0VmFsdWUoIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dC5EZWxldGVNZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQuUmVzdG9yZU1lIiwiIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6U3RyaW5nKQ0KICAgICAgICAgJFJlZ0tleTEuU2V0VmFsdWUoIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dCIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCgl9DQoNCgkkUmVnS2V5MiA9ICRSZWcuT3BlblN1YktleSgkUmVnUGF0aDIpDQoJSWYgKCRSZWdLZXkyIC1lcSAkbnVsbCkNCgl7DQoJCSRSZWcuQ3JlYXRlU3ViS2V5KCIkUmVnUGF0aDIiKQ0KIAkgICAgJFJlZ0tleTIgPSAkUmVnLk9wZW5TdWJLZXkoIiRSZWdQYXRoMiIsJHRydWUpDQogICAgICAgICRSZWdLZXkyLlNldFZhbHVlKCJEaXNhYmxlQ3VzdG9tRm9ybUl0ZW1TY3JpcHQiLCIwIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6RFdPUkQpDQoJfQ0KCUVsc2UNCiAgICB7DQogICAgICAgICRSZWdLZXkyID0gJFJlZy5PcGVuU3ViS2V5KCIkUmVnUGF0aDIiLCR0cnVlKQ0KICAgICAgICAgICRSZWdLZXkyLlNldFZhbHVlKCJEaXNhYmxlQ3VzdG9tRm9ybUl0ZW1TY3JpcHQiLCIwIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6RFdPUkQpDQogICAgfQ0KDQoJJFJlZ0tleTMgPSAkUmVnMi5PcGVuU3ViS2V5KCRSZWdQYXRoMykNCglJZiAoJFJlZ0tleTMgLWVxICRudWxsKQ0KCXsNCgkJJFJlZzIuQ3JlYXRlU3ViS2V5KCIkUmVnUGF0aDMiKQ0KIAkgICAgJFJlZ0tleTMgPSAkUmVnMi5PcGVuU3ViS2V5KCIkUmVnUGF0aDMiLCR0cnVlKQ0KICAgICAgICAkUmVnS2V5My5TZXRWYWx1ZSgiRW5hYmxlUm9hbWluZ0ZvbGRlckhvbWVwYWdlcyIsIjEiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpEV09SRCkNCgl9DQoJRWxzZQ0KICAgIHsNCiAgICAgICAgJFJlZ0tleTMgPSAkUmVnMi5PcGVuU3ViS2V5KCIkUmVnUGF0aDMiLCR0cnVlKQ0KICAgICAgICAkUmVnS2V5My5TZXRWYWx1ZSgiRW5hYmxlUm9hbWluZ0ZvbGRlckhvbWVwYWdlcyIsIjEiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpEV09SRCkNCiAgICB9DQp9DQoNCg0KDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyBDaGVjayBPUyBUeXBlDQpUcnkNCnsNCiAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gIlN0b3AiOyAjTWFrZSBhbGwgZXJyb3JzIHRlcm1pbmF0aW5nDQogICAgJFN5c3RlbSA9IGd3bWkgV2luMzJfQ29tcHV0ZXJTeXN0ZW0gIyBub3JtYWxseSBub24tdGVybWluYXRpbmcNCiAgICAkVHlwZSA9ICRTeXN0ZW0uU3lzdGVtVHlwZQ0KDQogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQogICAgIyBDaGVjayBPdXRsb29rLmV4ZSBWZXJzaW9uDQogICAgVHJ5DQogICAgew0KICAgICAgICAjICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScNCiAgICAgICAgJFJlZyA9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXldOjpPcGVuQmFzZUtleSgnTG9jYWxNYWNoaW5lJywgJ2RlZmF1bHQnKQ0KICAgICAgICAkUmVnMiA9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXldOjpPcGVuQmFzZUtleSgnQ3VycmVudFVzZXInLCAnZGVmYXVsdCcpDQoNCiAgICAgICAgSUYgKCRUeXBlIC1lcSAneDY0LWJhc2VkIFBDJykNCiAgICAgICAgew0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNC4wXE91dGxvb2tcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgzID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTRcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIlNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCgkJCQkkUmVnUGF0aDEgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KCQkJCSRSZWdQYXRoMiA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCQkkUmVnUGF0aDMgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTVcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIlNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiU09GVFdBUkVcV09XNjQzMk5vZGVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICAkUmVnUGF0aDMgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgRWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTRcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KCQkJCSRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIElGIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpDQogICAgICAgICAgICB7DQoJCQkgICAgJFJlZ1BhdGgxID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXEZvcm1zXFRydXN0ZWRGb3JtU2NyaXB0TGlzdCINCgkJCSAgICAkUmVnUGF0aDIgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQoJCQkgICAgJFJlZ1BhdGgzID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJICAgIFNldFJlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICAkUmVnUGF0aDMgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcU2VjdXJpdHkiDQoJCQkgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgQ2F0Y2gNCiAgICB7DQogICAgICAgIElmICgkXy5FeGNlcHRpb24uRXJyb3JDb2RlIC1lcSAiMHg4MDA3MDZCQSIpDQogICAgICAgIHsNCiAgICAgICAgICAgIFdyaXRlLUhvc3QgJ1dNSV8tX1JQQ19TZXJ2ZXJfVW5hdmFpbGFibGUnDQogICAgICAgIH0NCiAgICAgICAgRWxzZUlmICgkXy5FeGNlcHRpb24uRXJyb3JDb2RlIC1lcSAiMHg4MDA3MDAwNSIpDQogICAgICAgIHsNCiAgICAgICAgICAgIFdyaXRlLUhvc3QgJ1dNSV8tX0FjY2Vzc19pc19EZW5pZWQnDQogICAgICAgIH0NCiAgICAgICAgRWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBbc3RyaW5nXSRWZXI4NiA9ICRlcnJvclswXSANCiAgICAgICAgICAgIFdyaXRlLUhvc3QgKCgkVmVyODYgLXNwbGl0ICdbXHJdJylbMF0pDQogICAgICAgIH0NCiAgICB9DQogICAgRmluYWxseQ0KICAgIHsNCiAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJDb250aW51ZSI7ICNSZXNldCB0aGUgZXJyb3IgYWN0aW9uIHByZWYgdG8gZGVmYXVsdA0KICAgIH0NCg0KICAgICMgQ0hFQ0sgSUYgT1VUTE9PSyBXQVMgRk9VTkQgQU5ZV0hFUkUNCiAgICBJRiAoKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikpDQogICAgICAgIHt9DQogICAgICAgIEVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAge1dyaXRlLUhvc3QgJ0NvbXBsaWFudCd9DQogICAgICAgIH0NCg0KfQ0KQ2F0Y2gNCnsNCiAgICBJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzA2QkEiKQ0KICAgIHsNCiAgICAgICAgV3JpdGUtSG9zdCAnV01JXy1fUlBDX1NlcnZlcl9VbmF2YWlsYWJsZScNCiAgICB9DQogICAgRWxzZUlmICgkXy5FeGNlcHRpb24uRXJyb3JDb2RlIC1lcSAiMHg4MDA3MDAwNSIpDQogICAgew0KICAgICAgICBXcml0ZS1Ib3N0ICdXTUlfLV9BY2Nlc3NfaXNfRGVuaWVkJw0KICAgIH0NCiAgICBFbHNlDQogICAgew0KICAgICAgICBbc3RyaW5nXSRWZXI4NiA9ICRlcnJvclswXSANCiAgICAgICAgV3JpdGUtSG9zdCAoKCRWZXI4NiAtc3BsaXQgJ1tccl0nKVswXSkNCiAgICB9DQp9DQpGaW5hbGx5DQp7DQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJDb250aW51ZSI7ICNSZXNldCB0aGUgZXJyb3IgYWN0aW9uIHByZWYgdG8gZGVmYXVsdA0KfQ0K # ENCODEDSCRIPT# End Configuration Manager encoded script block
Function SetReg ($RegPath1,$RegPath2,$RegPath3)
{
	$RegKey1 = $Reg.OpenSubKey($RegPath1)
	If ($RegKey1 -eq $null)
	{
		$Reg.CreateSubKey("$RegPath1")
		$RegKey1 = $Reg.OpenSubKey("$RegPath1",$true)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.PendingArchive","",[Microsoft.Win32.RegistryValueKind]::String)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.PendingArchive.ArchiveMe","",[Microsoft.Win32.RegistryValueKind]::String)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.Shortcut.DeleteMe","",[Microsoft.Win32.RegistryValueKind]::String)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.Shortcut.RestoreMe","",[Microsoft.Win32.RegistryValueKind]::String)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.Shortcut","",[Microsoft.Win32.RegistryValueKind]::String)
	}
	Else
	{
		$RegKey1 = $Reg.OpenSubKey("$RegPath1",$true)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.PendingArchive","",[Microsoft.Win32.RegistryValueKind]::String)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.PendingArchive.ArchiveMe","",[Microsoft.Win32.RegistryValueKind]::String)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.Shortcut.DeleteMe","",[Microsoft.Win32.RegistryValueKind]::String)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.Shortcut.RestoreMe","",[Microsoft.Win32.RegistryValueKind]::String)
         $RegKey1.SetValue("IPM.Note.EnterpriseVault.Shortcut","",[Microsoft.Win32.RegistryValueKind]::String)
	}

	$RegKey2 = $Reg.OpenSubKey($RegPath2)
	If ($RegKey2 -eq $null)
	{
		$Reg.CreateSubKey("$RegPath2")
 	    $RegKey2 = $Reg.OpenSubKey("$RegPath2",$true)
        $RegKey2.SetValue("DisableCustomFormItemScript","0",[Microsoft.Win32.RegistryValueKind]::DWORD)
	}
	Else
    {
        $RegKey2 = $Reg.OpenSubKey("$RegPath2",$true)
          $RegKey2.SetValue("DisableCustomFormItemScript","0",[Microsoft.Win32.RegistryValueKind]::DWORD)
    }

	$RegKey3 = $Reg2.OpenSubKey($RegPath3)
	If ($RegKey3 -eq $null)
	{
		$Reg2.CreateSubKey("$RegPath3")
 	    $RegKey3 = $Reg2.OpenSubKey("$RegPath3",$true)
        $RegKey3.SetValue("EnableRoamingFolderHomepages","1",[Microsoft.Win32.RegistryValueKind]::DWORD)
	}
	Else
    {
        $RegKey3 = $Reg2.OpenSubKey("$RegPath3",$true)
        $RegKey3.SetValue("EnableRoamingFolderHomepages","1",[Microsoft.Win32.RegistryValueKind]::DWORD)
    }
}




##########################################################################################################################################
# Check OS Type
Try
{
    $ErrorActionPreference = "Stop"; #Make all errors terminating
    $System = gwmi Win32_ComputerSystem # normally non-terminating
    $Type = $System.SystemType

    ##########################################################################################################################################
    # Check Outlook.exe Version
    Try
    {
        # $ErrorActionPreference = 'SilentlyContinue'
        $Reg = [Microsoft.Win32.RegistryKey]::OpenBaseKey('LocalMachine', 'default')
        $Reg2 = [Microsoft.Win32.RegistryKey]::OpenBaseKey('CurrentUser', 'default')

        IF ($Type -eq 'x64-based PC')
        {
            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office14\OUTLOOK.EXE")
            {
                $RegPath1 = "SOFTWARE\Microsoft\Office\14.0\Outlook\Outlook\Forms\TrustedFormScriptList"
                $RegPath2 = "SOFTWARE\Microsoft\Office\14.0\Outlook\Outlook\Security"
                $RegPath3 = "SOFTWARE\Microsoft\Office\14.0\Outlook\Outlook\Security"
                SetReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
            IF (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office14\OUTLOOK.EXE")
            {
                $RegPath1 = "SOFTWARE\WOW6432Node\Microsoft\Office\14.0\Outlook\Forms\TrustedFormScriptList"
				$RegPath2 = "SOFTWARE\WOW6432Node\Microsoft\Office\14.0\Outlook\Security"
				$RegPath3 = "SOFTWARE\Microsoft\Office\14.0\Outlook\Security"
                SetReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }

            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office15\OUTLOOK.EXE")
            {
				$RegPath1 = "SOFTWARE\Microsoft\Office\15.0\Outlook\Forms\TrustedFormScriptList"
				$RegPath2 = "SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
				$RegPath3 = "SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
                SetReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
            IF (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office15\OUTLOOK.EXE")
            {
                $RegPath1 = "SOFTWARE\WOW6432Node\Microsoft\Office\15.0\Outlook\Forms\TrustedFormScriptList"
                $RegPath2 = "SOFTWARE\WOW6432Node\Microsoft\Office\15.0\Outlook\Security"
                $RegPath3 = "SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
                SetReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }


            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office16\OUTLOOK.EXE")
            {
                $RegPath1 = "SOFTWARE\Microsoft\Office\16.0\Outlook\Forms\TrustedFormScriptList"
				$RegPath2 = "SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
				$RegPath3 = "SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
                SetReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3

            }
            IF (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office16\OUTLOOK.EXE")
            {
                $RegPath1 = "SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Outlook\Forms\TrustedFormScriptList"
                $RegPath2 = "SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Outlook\Security"
                $RegPath3 = "SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
                SetReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
        }
        Else
        {
            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office14\OUTLOOK.EXE")
            {
				$RegPath1 = "SOFTWARE\Microsoft\Office\14.0\Outlook\Forms\TrustedFormScriptList"
				$RegPath2 = "SOFTWARE\Microsoft\Office\14.0\Outlook\Security"
				$RegPath3 = "SOFTWARE\Microsoft\Office\14.0\Outlook\Security"
                SetReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office15\OUTLOOK.EXE")
            {
			    $RegPath1 = "SOFTWARE\Microsoft\Office\15.0\Outlook\Forms\TrustedFormScriptList"
			    $RegPath2 = "SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
			    $RegPath3 = "SOFTWARE\Microsoft\Office\15.0\Outlook\Security"
			    SetReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
            IF (Test-Path -Path "C:\Program Files\Microsoft Office\Office16\OUTLOOK.EXE")
            {
                $RegPath1 = "SOFTWARE\Microsoft\Office\16.0\Outlook\Forms\TrustedFormScriptList"
                $RegPath2 = "SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
                $RegPath3 = "SOFTWARE\Microsoft\Office\16.0\Outlook\Security"
			    SetReg -RegPath1 $RegPath1 -RegPath2 $RegPath2 -RegPath3 $RegPath3
            }
        }
    }
    Catch
    {
        If ($_.Exception.ErrorCode -eq "0x800706BA")
        {
            Write-Host 'WMI_-_RPC_Server_Unavailable'
        }
        ElseIf ($_.Exception.ErrorCode -eq "0x80070005")
        {
            Write-Host 'WMI_-_Access_is_Denied'
        }
        Else
        {
            [string]$Ver86 = $error[0] 
            Write-Host (($Ver86 -split '[\r]')[0])
        }
    }
    Finally
    {
        $ErrorActionPreference = "Continue"; #Reset the error action pref to default
    }

    # CHECK IF OUTLOOK WAS FOUND ANYWHERE
    IF ((Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office14\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office15\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files (x86)\Microsoft Office\Office16\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files\Microsoft Office\Office14\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files\Microsoft Office\Office15\OUTLOOK.EXE") -or `
        (Test-Path -Path "C:\Program Files\Microsoft Office\Office16\OUTLOOK.EXE"))
        {}
        Else
        {
            {Write-Host 'Compliant'}
        }

}
Catch
{
    If ($_.Exception.ErrorCode -eq "0x800706BA")
    {
        Write-Host 'WMI_-_RPC_Server_Unavailable'
    }
    ElseIf ($_.Exception.ErrorCode -eq "0x80070005")
    {
        Write-Host 'WMI_-_Access_is_Denied'
    }
    Else
    {
        [string]$Ver86 = $error[0] 
        Write-Host (($Ver86 -split '[\r]')[0])
    }
}
Finally
{
    $ErrorActionPreference = "Continue"; #Reset the error action pref to default
}


# ENCODEDSCRIPT # Begin Configuration Manager encoded script block # 77u/RnVuY3Rpb24gU2V0UmVnICgkUmVnUGF0aDEsJFJlZ1BhdGgyLCRSZWdQYXRoMykNCnsNCgkkUmVnS2V5MSA9ICRSZWcuT3BlblN1YktleSgkUmVnUGF0aDEpDQoJSWYgKCRSZWdLZXkxIC1lcSAkbnVsbCkNCgl7DQoJCSRSZWcuQ3JlYXRlU3ViS2V5KCIkUmVnUGF0aDEiKQ0KCQkkUmVnS2V5MSA9ICRSZWcuT3BlblN1YktleSgiJFJlZ1BhdGgxIiwkdHJ1ZSkNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuUGVuZGluZ0FyY2hpdmUiLCIiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpTdHJpbmcpDQogICAgICAgICAkUmVnS2V5MS5TZXRWYWx1ZSgiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlBlbmRpbmdBcmNoaXZlLkFyY2hpdmVNZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQuRGVsZXRlTWUiLCIiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpTdHJpbmcpDQogICAgICAgICAkUmVnS2V5MS5TZXRWYWx1ZSgiSVBNLk5vdGUuRW50ZXJwcmlzZVZhdWx0LlNob3J0Y3V0LlJlc3RvcmVNZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQiLCIiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpTdHJpbmcpDQoJfQ0KCUVsc2UNCgl7DQoJCSRSZWdLZXkxID0gJFJlZy5PcGVuU3ViS2V5KCIkUmVnUGF0aDEiLCR0cnVlKQ0KICAgICAgICAgJFJlZ0tleTEuU2V0VmFsdWUoIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5QZW5kaW5nQXJjaGl2ZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuUGVuZGluZ0FyY2hpdmUuQXJjaGl2ZU1lIiwiIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6U3RyaW5nKQ0KICAgICAgICAgJFJlZ0tleTEuU2V0VmFsdWUoIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dC5EZWxldGVNZSIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCiAgICAgICAgICRSZWdLZXkxLlNldFZhbHVlKCJJUE0uTm90ZS5FbnRlcnByaXNlVmF1bHQuU2hvcnRjdXQuUmVzdG9yZU1lIiwiIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6U3RyaW5nKQ0KICAgICAgICAgJFJlZ0tleTEuU2V0VmFsdWUoIklQTS5Ob3RlLkVudGVycHJpc2VWYXVsdC5TaG9ydGN1dCIsIiIsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZhbHVlS2luZF06OlN0cmluZykNCgl9DQoNCgkkUmVnS2V5MiA9ICRSZWcuT3BlblN1YktleSgkUmVnUGF0aDIpDQoJSWYgKCRSZWdLZXkyIC1lcSAkbnVsbCkNCgl7DQoJCSRSZWcuQ3JlYXRlU3ViS2V5KCIkUmVnUGF0aDIiKQ0KIAkgICAgJFJlZ0tleTIgPSAkUmVnLk9wZW5TdWJLZXkoIiRSZWdQYXRoMiIsJHRydWUpDQogICAgICAgICRSZWdLZXkyLlNldFZhbHVlKCJEaXNhYmxlQ3VzdG9tRm9ybUl0ZW1TY3JpcHQiLCIwIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6RFdPUkQpDQoJfQ0KCUVsc2UNCiAgICB7DQogICAgICAgICRSZWdLZXkyID0gJFJlZy5PcGVuU3ViS2V5KCIkUmVnUGF0aDIiLCR0cnVlKQ0KICAgICAgICAgICRSZWdLZXkyLlNldFZhbHVlKCJEaXNhYmxlQ3VzdG9tRm9ybUl0ZW1TY3JpcHQiLCIwIixbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5VmFsdWVLaW5kXTo6RFdPUkQpDQogICAgfQ0KDQoJJFJlZ0tleTMgPSAkUmVnMi5PcGVuU3ViS2V5KCRSZWdQYXRoMykNCglJZiAoJFJlZ0tleTMgLWVxICRudWxsKQ0KCXsNCgkJJFJlZzIuQ3JlYXRlU3ViS2V5KCIkUmVnUGF0aDMiKQ0KIAkgICAgJFJlZ0tleTMgPSAkUmVnMi5PcGVuU3ViS2V5KCIkUmVnUGF0aDMiLCR0cnVlKQ0KICAgICAgICAkUmVnS2V5My5TZXRWYWx1ZSgiRW5hYmxlUm9hbWluZ0ZvbGRlckhvbWVwYWdlcyIsIjEiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpEV09SRCkNCgl9DQoJRWxzZQ0KICAgIHsNCiAgICAgICAgJFJlZ0tleTMgPSAkUmVnMi5PcGVuU3ViS2V5KCIkUmVnUGF0aDMiLCR0cnVlKQ0KICAgICAgICAkUmVnS2V5My5TZXRWYWx1ZSgiRW5hYmxlUm9hbWluZ0ZvbGRlckhvbWVwYWdlcyIsIjEiLFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlWYWx1ZUtpbmRdOjpEV09SRCkNCiAgICB9DQp9DQoNCg0KDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyBDaGVjayBPUyBUeXBlDQpUcnkNCnsNCiAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gIlN0b3AiOyAjTWFrZSBhbGwgZXJyb3JzIHRlcm1pbmF0aW5nDQogICAgJFN5c3RlbSA9IGd3bWkgV2luMzJfQ29tcHV0ZXJTeXN0ZW0gIyBub3JtYWxseSBub24tdGVybWluYXRpbmcNCiAgICAkVHlwZSA9ICRTeXN0ZW0uU3lzdGVtVHlwZQ0KDQogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQogICAgIyBDaGVjayBPdXRsb29rLmV4ZSBWZXJzaW9uDQogICAgVHJ5DQogICAgew0KICAgICAgICAjICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScNCiAgICAgICAgJFJlZyA9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXldOjpPcGVuQmFzZUtleSgnTG9jYWxNYWNoaW5lJywgJ2RlZmF1bHQnKQ0KICAgICAgICAkUmVnMiA9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXldOjpPcGVuQmFzZUtleSgnQ3VycmVudFVzZXInLCAnZGVmYXVsdCcpDQoNCiAgICAgICAgSUYgKCRUeXBlIC1lcSAneDY0LWJhc2VkIFBDJykNCiAgICAgICAgew0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNC4wXE91dGxvb2tcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgzID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTRcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIlNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCgkJCQkkUmVnUGF0aDEgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KCQkJCSRSZWdQYXRoMiA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCgkJCQkkUmVnUGF0aDMgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTVcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQogICAgICAgICAgICAgICAgJFJlZ1BhdGgyID0gIlNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE1LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTZcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiU09GVFdBUkVcV09XNjQzMk5vZGVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJTT0ZUV0FSRVxXT1c2NDMyTm9kZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICAkUmVnUGF0aDMgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcU2VjdXJpdHkiDQogICAgICAgICAgICAgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgRWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBJRiAoVGVzXX1QYXRoIC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBPZmZpY2VcT2ZmaWNlMTRcT1VUTE9PSy5FWEUiKQ0KICAgICAgICAgICAgew0KCQkJCSRSZWdQYXRoMSA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xGb3Jtc1xUcnVzdGVkRm9ybVNjcmlwdExpc3QiDQoJCQkJJFJlZ1BhdGgyID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTQuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJCSRSZWdQYXRoMyA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE0LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICBTZXRSZWcgLVJlZ1BhdGgxICRSZWdQYXRoMSAtUmVnUGF0aDIgJFJlZ1BhdGgyIC1SZWdQYXRoMyAkUmVnUGF0aDMNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIElGIChUZXN0LVBhdGggLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IE9mZmljZVxPZmZpY2UxNVxPVVRMT09LLkVYRSIpDQogICAgICAgICAgICB7DQoJCQkgICAgJFJlZ1BhdGgxID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXEZvcm1zXFRydXN0ZWRGb3JtU2NyaXB0TGlzdCINCgkJCSAgICAkUmVnUGF0aDIgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNS4wXE91dGxvb2tcU2VjdXJpdHkiDQoJCQkgICAgJFJlZ1BhdGgzID0gIlNPRlRXQVJFXE1pY3Jvc29mdFxPZmZpY2VcMTUuMFxPdXRsb29rXFNlY3VyaXR5Ig0KCQkJICAgIFNldFJlZyAtUmVnUGF0aDEgJFJlZ1BhdGgxIC1SZWdQYXRoMiAkUmVnUGF0aDIgLVJlZ1BhdGgzICRSZWdQYXRoMw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgSUYgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkUmVnUGF0aDEgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcRm9ybXNcVHJ1c3RlZEZvcm1TY3JpcHRMaXN0Ig0KICAgICAgICAgICAgICAgICRSZWdQYXRoMiA9ICJTT0ZUV0FSRVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xTZWN1cml0eSINCiAgICAgICAgICAgICAgICAkUmVnUGF0aDMgPSAiU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcU2VjdXJpdHkiDQoJCQkgICAgU2V0UmVnIC1SZWdQYXRoMSAkUmVnUGF0aDEgLVJlZ1BhdGgyICRSZWdQYXRoMiAtUmVnUGF0aDMgJFJlZ1BhdGgzDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgQ2F0Y2gNCiAgICB7DQogICAgICAgIElmICgkXy5FeGNlcHRpb24uRXJyb3JDb2RlIC1lcSAiMHg4MDA3MDZCQSIpDQogICAgICAgIHsNCiAgICAgICAgICAgIFdyaXRlLUhvc3QgJ1dNSV8tX1JQQ19TZXJ2ZXJfVW5hdmFpbGFibGUnDQogICAgICAgIH0NCiAgICAgICAgRWxzZUlmICgkXy5FeGNlcHRpb24uRXJyb3JDb2RlIC1lcSAiMHg4MDA3MDAwNSIpDQogICAgICAgIHsNCiAgICAgICAgICAgIFdyaXRlLUhvc3QgJ1dNSV8tX0FjY2Vzc19pc19EZW5pZWQnDQogICAgICAgIH0NCiAgICAgICAgRWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBbc3RyaW5nXSRWZXI4NiA9ICRlcnJvclswXSANCiAgICAgICAgICAgIFdyaXRlLUhvc3QgKCgkVmVyODYgLXNwbGl0ICdbXHJdJylbMF0pDQogICAgICAgIH0NCiAgICB9DQogICAgRmluYWxseQ0KICAgIHsNCiAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJDb250aW51ZSI7ICNSZXNldCB0aGUgZXJyb3IgYWN0aW9uIHByZWYgdG8gZGVmYXVsdA0KICAgIH0NCg0KICAgICMgQ0hFQ0sgSUYgT1VUTE9PSyBXQVMgRk9VTkQgQU5ZV0hFUkUNCiAgICBJRiAoKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE0XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE1XE9VVExPT0suRVhFIikgLW9yIGANCiAgICAgICAgKFRlc3QtUGF0aCAtUGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xNaWNyb3NvZnQgT2ZmaWNlXE9mZmljZTE2XE9VVExPT0suRVhFIikpDQogICAgICAgIHt9DQogICAgICAgIEVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAge1dyaXRlLUhvc3QgJ0NvbXBsaWFudCd9DQogICAgICAgIH0NCg0KfQ0KQ2F0Y2gNCnsNCiAgICBJZiAoJF8uRXhjZXB0aW9uLkVycm9yQ29kZSAtZXEgIjB4ODAwNzA2QkEiKQ0KICAgIHsNCiAgICAgICAgV3JpdGUtSG9zdCAnV01JXy1fUlBDX1NlcnZlcl9VbmF2YWlsYWJsZScNCiAgICB9DQogICAgRWxzZUlmICgkXy5FeGNlcHRpb24uRXJyb3JDb2RlIC1lcSAiMHg4MDA3MDAwNSIpDQogICAgew0KICAgICAgICBXcml0ZS1Ib3N0ICdXTUlfLV9BY2Nlc3NfaXNfRGVuaWVkJw0KICAgIH0NCiAgICBFbHNlDQogICAgew0KICAgICAgICBbc3RyaW5nXSRWZXI4NiA9ICRlcnJvclswXSANCiAgICAgICAgV3JpdGUtSG9zdCAoKCRWZXI4NiAtc3BsaXQgJ1tccl0nKVswXSkNCiAgICB9DQp9DQpGaW5hbGx5DQp7DQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJDb250aW51ZSI7ICNSZXNldCB0aGUgZXJyb3IgYWN0aW9uIHByZWYgdG8gZGVmYXVsdA0KfQ0K # ENCODEDSCRIPT# End Configuration Manager encoded script block

